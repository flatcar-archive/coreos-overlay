<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>diff</title>
<meta name="Generator" content="Vim/8.0">
<meta name="plugin-version" content="vim8.1_v2">
<meta name="settings" content="number_lines,whole_filler,use_css,no_foldcolumn,expand_tabs,line_ids,prevent_copy=,use_input_for_pc=fallback">
<meta name="colorscheme" content="gruvbox">
<style>
<!--
pre { font-family: monospace; color: #ffd7af; background-color: #262626; }
body { font-family: monospace; color: #ffd7af; background-color: #262626; }
* { font-size: 1em; }
.GruvboxBlue { color: #87afaf; }
.GruvboxPurple { color: #d787af; }
.LineNr { color: #767676; }
.GruvboxAqua { color: #87af87; }
.Normal { color: #ffd7af; background-color: #262626; padding-bottom: 1px; }
.GruvboxOrange { color: #ff8700; }
.Comment { color: #8a8a8a; }
.Folded { color: #8a8a8a; background-color: #3a3a3a; padding-bottom: 1px; }
.Todo { color: #ffd7af; background-color: #262626; padding-bottom: 1px; font-weight: bold; }
.String { color: #afaf00; }
.GruvboxRed { color: #d75f5f; }
.Error { color: #262626; background-color: #d75f5f; font-weight: bold; }
.GruvboxGreenBold { color: #afaf00; font-weight: bold; }
.DiffChange { color: #262626; background-color: #87af87; }
.DiffDelete { color: #262626; background-color: #d75f5f; }
.DiffText { color: #262626; background-color: #ffaf00; }
.DiffAdd { color: #262626; background-color: #afaf00; }
-->
<!--
table { table-layout: fixed; }
html, body, table, tbody { width: 100%; margin: 0; padding: 0; }
table, td, th { border: 1px solid; }
td { vertical-align: top; }
th, td { width: 50.0%; }
td div { overflow: auto; }
-->
</style>
<script>
<!--

/* function to open any folds containing a jumped-to line before jumping to it */
function JumpToLine()
{
  var lineNum;
  lineNum = window.location.hash;
  lineNum = lineNum.substr(1); /* strip off '#' */

  if (lineNum.indexOf('L') == -1) {
    lineNum = 'L'+lineNum;
  }
  if (lineNum.indexOf('W') == -1) {
    lineNum = 'W1'+lineNum;
  }
  var lineElem = document.getElementById(lineNum);
  /* Always jump to new location even if the line was hidden inside a fold, or
   * we corrected the raw number to a line ID.
   */
  if (lineElem) {
    lineElem.scrollIntoView(true);
  }
  return true;
}
if ('onhashchange' in window) {
  window.onhashchange = JumpToLine;
}

-->
</script>
</head>
<body onload='JumpToLine();'>
<table id='vimCodeElement'>
<tr>
<th>systemd-250.3.ebuild</th>
<th>/home/sayan/code/work/gentoo/sys-apps/systemd/systemd-252.3.ebuild</th>
</tr><tr>
<td><div>
<pre>
<span id="W1L1" class="LineNr">  1 </span><span class="Comment"># Copyright 2011-2022 Gentoo Authors</span>
<span id="W1L2" class="LineNr">  2 </span><span class="Comment"># Distributed under the terms of the GNU General Public License v2</span>
<span id="W1L3" class="LineNr">  3 </span>
<span id="W1L4" class="LineNr">  4 </span><span class="GruvboxBlue">EAPI</span>=<span class="GruvboxPurple">7</span>
<span id="W1L5" class="LineNr">  5 </span><span class="GruvboxBlue DiffChange">PYTHON_COMPAT</span><span class="DiffChange">=</span><span class="GruvboxAqua DiffChange">(</span><span class="DiffChange"> python3_</span><span class="GruvboxOrange DiffChange">{</span><span class="GruvboxPurple DiffChange">8</span><span class="DiffChange">..</span><span class="GruvboxPurple DiffChange">1</span><span class="GruvboxPurple DiffText">0</span><span class="GruvboxOrange DiffChange">}</span><span class="DiffChange"> </span><span class="GruvboxAqua DiffChange">)</span><span class="DiffChange">                                                                                                                                         </span>
<span id="W1L6" class="LineNr">  6 </span>
<span id="W1L7" class="LineNr">  7 </span><span class="Comment"># Avoid QA warnings</span>
<span id="W1L8" class="LineNr">  8 </span><span class="GruvboxBlue">TMPFILES_OPTIONAL</span>=<span class="GruvboxPurple">1</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L9" class="LineNr">  9 </span>
<span id="W1L10" class="LineNr"> 10 </span><span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">==</span> <span class="GruvboxPurple">9999</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L11" class="LineNr"> 11 </span>  <span class="GruvboxBlue">EGIT_REPO_URI</span>=<span class="Normal">&quot;</span><span class="String"><a href="https://github.com/systemd/systemd.git">https://github.com/systemd/systemd.git</a></span><span class="Normal">&quot;</span>
<span id="W1L12" class="LineNr"> 12 </span>  inherit git-r3
<span id="W1L13" class="LineNr"> 13 </span><span class="GruvboxRed">else</span>
<span id="W1L14" class="LineNr"> 14 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">==</span> <span class="String">*.*</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L15" class="Folded"> 15 </span><span class="Folded">+--  2 lines: MY_PN=systemd-stable--------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L17" class="LineNr"> 17 </span>    <span class="GruvboxBlue">MY_PN</span>=systemd
<span id="W1L18" class="LineNr"> 18 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L19" class="LineNr"> 19 </span>  <span class="GruvboxBlue">MY_PV</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="Normal">/</span>_<span class="Normal">/</span>-<span class="GruvboxAqua">}</span>
<span id="W1L20" class="LineNr"> 20 </span>  <span class="GruvboxBlue">MY_P</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PN</span><span class="GruvboxAqua">}</span>-<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PV</span><span class="GruvboxAqua">}</span>
<span id="W1L21" class="LineNr"> 21 </span>  <span class="GruvboxBlue">S</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">WORKDIR</span><span class="GruvboxAqua">}</span>/<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_P</span><span class="GruvboxAqua">}</span>
<span id="W1L22" class="LineNr"> 22 </span>  <span class="GruvboxBlue">SRC_URI</span>=<span class="Normal">&quot;</span><span class="String"><a href="https://github.com/systemd/">https://github.com/systemd/</a></span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PN</span><span class="GruvboxAqua">}</span><span class="String">/archive/v</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PV</span><span class="GruvboxAqua">}</span><span class="String">/</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_P</span><span class="GruvboxAqua">}</span><span class="String">.tar.gz</span><span class="Normal">&quot;</span>
<span id="W1L23" class="LineNr"> 23 </span><span class="DiffChange">  </span><span class="Comment DiffText"># Flatcar: Stabilize for amd64 and arm64.</span><span class="DiffChange">                                                                                                                               </span>
<span id="W1L24" class="LineNr"> 24 </span><span class="DiffAdd">  </span><span class="GruvboxBlue DiffAdd">KEYWORDS</span><span class="DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd">~alpha amd64 ~arm arm64 ~hppa ~ia64 ~mips ~ppc ~ppc64 ~riscv ~sparc ~x86</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                     </span>
<span id="W1L25" class="LineNr"> 25 </span><span class="GruvboxRed">fi</span>
<span id="W1L26" class="LineNr"> 26 </span>
<span id="W1L27" class="LineNr"> 27 </span><span class="Comment DiffText"># Flatcar: We don't use gen_usr_ldscript so dropping usr-ldscript.</span><span class="DiffChange">                                                                                                        </span>
<span id="W1L28" class="LineNr"> 28 </span><span class="Comment DiffText"># Adding tmpfiles, since we use it for installing some files.</span><span class="DiffChange">                                                                                                             </span>
<span id="W1L29" class="LineNr"> 29 </span><span class="DiffAdd">inherit bash-completion-r1 linux-info meson-multilib pam python-any-r1 systemd toolchain-funcs udev tmpfiles</span><span class="DiffAdd">                                                              </span>
<span id="W1L30" class="LineNr"> 30 </span>
<span id="W1L31" class="LineNr"> 31 </span><span class="GruvboxBlue">DESCRIPTION</span>=<span class="Normal">&quot;</span><span class="String">System and service manager for Linux</span><span class="Normal">&quot;</span>
<span id="W1L32" class="LineNr"> 32 </span><span class="GruvboxBlue DiffChange">HOMEPAGE</span><span class="DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">http</span><span class="String DiffText">s://www.freedesktop.org/wiki/Software/systemd</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                              </span>
<span id="W1L33" class="LineNr"> 33 </span>
<span id="W1L34" class="LineNr"> 34 </span><span class="GruvboxBlue">LICENSE</span>=<span class="Normal">&quot;</span><span class="String">GPL-2 LGPL-2.1 MIT public-domain</span><span class="Normal">&quot;</span>
<span id="W1L35" class="LineNr"> 35 </span><span class="GruvboxBlue">SLOT</span>=<span class="Normal">&quot;</span><span class="String">0/2</span><span class="Normal">&quot;</span>
<span id="W1L36" class="LineNr"> 36 </span><span class="GruvboxBlue">IUSE</span>=<span class="Normal">&quot;</span>
<span id="W1L37" class="LineNr"> 37 </span><span class="String DiffChange">  acl apparmor audit </span><span class="String DiffText">build </span><span class="String DiffChange">cgroup-hybrid cryptsetup curl +dns-over-tls elfutils</span><span class="DiffChange">                                                                                           </span>
<span id="W1L38" class="LineNr"> 38 </span><span class="String DiffChange">  fido2 +gcrypt gnuefi gnutls homed h</span><span class="String DiffText">ostnamed-fallback http idn importd</span><span class="String DiffChange"> +kmod</span><span class="DiffChange">                                                                                             </span>
<span id="W1L39" class="LineNr"> 39 </span><span class="String DiffChange">  +lz4 lzma </span><span class="String DiffText">nat </span><span class="String DiffChange">+openssl pam pcre pkcs11 policykit pwquality qrcode</span><span class="DiffChange">                                                                                                       </span>
<span id="W1L40" class="LineNr"> 40 </span><span class="String">  +resolvconf +seccomp selinux split-usr +sysv-utils test tpm vanilla xkb +zstd</span>
<span id="W1L41" class="LineNr"> 41 </span><span class="Normal">&quot;</span>
<span id="W1L42" class="LineNr"> 42 </span><span class="GruvboxBlue">REQUIRED_USE</span>=<span class="Normal">&quot;</span>
<span id="W1L43" class="LineNr"> 43 </span><span class="String">  dns-over-tls? ( || ( gnutls openssl ) )</span>
<span id="W1L44" class="LineNr"> 44 </span><span class="String">  homed? ( cryptsetup pam openssl )</span>
<span id="W1L45" class="LineNr"> 45 </span><span class="String">  importd? ( curl lzma || ( gcrypt openssl ) )</span>
<span id="W1L46" class="LineNr"> 46 </span><span class="String DiffAdd">  policykit? ( !hostnamed-fallback )</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L47" class="LineNr"> 47 </span><span class="String">  pwquality? ( homed )</span>
<span id="W1L48" class="LineNr"> 48 </span><span class="Normal">&quot;</span>
<span id="W1L49" class="LineNr"> 49 </span><span class="GruvboxBlue">RESTRICT</span>=<span class="Normal">&quot;</span><span class="String">!test? ( test )</span><span class="Normal">&quot;</span>
<span id="W1L50" class="LineNr"> 50 </span>
<span id="W1L51" class="LineNr"> 51 </span><span class="GruvboxBlue DiffChange">MINKV</span><span class="DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">3.11</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                                              </span>
<span id="W1L52" class="LineNr"> 52 </span>
<span id="W1L53" class="LineNr"> 53 </span><span class="GruvboxBlue">COMMON_DEPEND</span>=<span class="Normal">&quot;</span>
<span id="W1L54" class="LineNr"> 54 </span><span class="String">  &gt;=sys-apps/util-linux-2.30:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W1L55" class="LineNr"> 55 </span><span class="String">  sys-libs/libcap:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W1L56" class="LineNr"> 56 </span><span class="String">  virtual/libcrypt:=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W1L57" class="LineNr"> 57 </span><span class="String">  acl? ( sys-apps/acl:0= )</span>
<span id="W1L58" class="Folded"> 58 </span><span class="Folded">+-- 11 lines: apparmor? ( sys-libs/libapparmor:0= )---------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L69" class="LineNr"> 69 </span><span class="String">    app-arch/bzip2:0=</span>
<span id="W1L70" class="LineNr"> 70 </span><span class="String">    sys-libs/zlib:0=</span>
<span id="W1L71" class="LineNr"> 71 </span><span class="String">  )</span>
<span id="W1L72" class="LineNr"> 72 </span><span class="String">  kmod? ( &gt;=sys-apps/kmod-15:0= )</span>
<span id="W1L73" class="LineNr"> 73 </span><span class="String">  lz4? ( &gt;=app-arch/lz4-0_p131:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W1L74" class="LineNr"> 74 </span><span class="String">  lzma? ( &gt;=app-arch/xz-utils-5.0.5-r1:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W1L75" class="LineNr"> 75 </span><span class="String DiffChange">  </span><span class="String DiffText">nat</span><span class="String DiffChange">? ( net-firewall/iptables:0= )</span><span class="DiffChange">                                                                                                                                       </span>
<span id="W1L76" class="LineNr"> 76 </span><span class="String">  openssl? ( &gt;=dev-libs/openssl-1.1.0:0= )</span>
<span id="W1L77" class="LineNr"> 77 </span><span class="String">  pam? ( sys-libs/pam:=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W1L78" class="LineNr"> 78 </span><span class="String">  pkcs11? ( app-crypt/p11-kit:0= )</span>
<span id="W1L79" class="LineNr"> 79 </span><span class="String">  pcre? ( dev-libs/libpcre2 )</span>
<span id="W1L80" class="LineNr"> 80 </span><span class="String">  pwquality? ( dev-libs/libpwquality:0= )</span>
<span id="W1L81" class="LineNr"> 81 </span><span class="String">  qrcode? ( media-gfx/qrencode:0= )</span>
<span id="W1L82" class="Folded"> 82 </span><span class="Folded">+-- 36 lines: seccomp? ( &gt;=sys-libs/libseccomp-2.3.3:0= )---------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L118" class="LineNr">118 </span><span class="String">  &gt;=acct-user/systemd-coredump-0-r1</span>
<span id="W1L119" class="LineNr">119 </span><span class="String">  &gt;=acct-user/systemd-network-0-r1</span>
<span id="W1L120" class="LineNr">120 </span><span class="String">  acct-user/systemd-oom</span>
<span id="W1L121" class="LineNr">121 </span><span class="String">  &gt;=acct-user/systemd-resolve-0-r1</span>
<span id="W1L122" class="LineNr">122 </span><span class="String">  &gt;=acct-user/systemd-timesync-0-r1</span>
<span id="W1L123" class="LineNr">123 </span><span class="String">  &gt;=sys-apps/baselayout-2.2</span>
<span id="W1L124" class="LineNr">124 </span><span class="String DiffChange">  </span><span class="String DiffText">hostnamed-fallback</span><span class="String DiffChange">? (</span><span class="DiffChange">                                                                                                                                                   </span>
<span id="W1L125" class="LineNr">125 </span><span class="String DiffChange">    </span><span class="String DiffText">acct-group/systemd-hostname</span><span class="DiffChange">                                                                                                                                           </span>
<span id="W1L126" class="LineNr">126 </span><span class="String DiffChange">    s</span><span class="String DiffText">ys-apps/dbus-broker</span><span class="DiffChange">                                                                                                                                                  </span>
<span id="W1L127" class="LineNr">127 </span><span class="String">  )</span>
<span id="W1L128" class="LineNr">128 </span><span class="String DiffAdd">  selinux? ( sec-policy/selinux-base-policy[systemd] )</span><span class="DiffAdd">                                                                                                                    </span>
<span id="W1L129" class="LineNr">129 </span><span class="String">  sysv-utils? (</span>
<span id="W1L130" class="LineNr">130 </span><span class="String">    !sys-apps/openrc[sysv-utils(-)]</span>
<span id="W1L131" class="LineNr">131 </span><span class="String">    !sys-apps/sysvinit</span>
<span id="W1L132" class="LineNr">132 </span><span class="String">  )</span>
<span id="W1L133" class="LineNr">133 </span><span class="String">  !sysv-utils? ( sys-apps/sysvinit )</span>
<span id="W1L134" class="LineNr">134 </span><span class="String">  resolvconf? ( !net-dns/openresolv )</span>
<span id="W1L135" class="LineNr">135 </span><span class="String DiffAdd">  !build? ( || (</span><span class="DiffAdd">                                                                                                                                                          </span>
<span id="W1L136" class="LineNr">136 </span><span class="String DiffAdd">    sys-apps/util-linux[kill(-)]</span><span class="DiffAdd">                                                                                                                                          </span>
<span id="W1L137" class="LineNr">137 </span><span class="String DiffAdd">    sys-process/procps[kill(+)]</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W1L138" class="LineNr">138 </span><span class="String DiffAdd">    sys-apps/coreutils[kill(-)]</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W1L139" class="LineNr">139 </span><span class="String DiffAdd">  ) )</span><span class="DiffAdd">                                                                                                                                                                     </span>
<span id="W1L140" class="LineNr">140 </span><span class="String">  !sys-apps/hwids[udev]</span>
<span id="W1L141" class="LineNr">141 </span><span class="String">  !sys-auth/nss-myhostname</span>
<span id="W1L142" class="LineNr">142 </span><span class="String">  !sys-fs/eudev</span>
<span id="W1L143" class="LineNr">143 </span><span class="String">  !sys-fs/udev</span>
<span id="W1L144" class="LineNr">144 </span><span class="Normal">&quot;</span>
<span id="W1L145" class="LineNr">145 </span>
<span id="W1L146" class="LineNr">146 </span><span class="Comment"># sys-apps/dbus: the daemon only (+ build-time lib dep for tests)</span>
<span id="W1L147" class="LineNr">147 </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L148" class="LineNr">148 </span><span class="Comment DiffAdd"># Flatcar: We don't have sys-fs/udev-init-scripts-34, so it's dropped.</span><span class="DiffAdd">                                                                                                    </span>
<span id="W1L149" class="LineNr">149 </span><span class="GruvboxBlue">PDEPEND</span>=<span class="Normal">&quot;</span><span class="String">&gt;=sys-apps/dbus-1.9.8[systemd]</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L150" class="LineNr">150 </span><span class="String">  policykit? ( sys-auth/polkit )</span>
<span id="W1L151" class="LineNr">151 </span><span class="String">  !vanilla? ( sys-apps/gentoo-systemd-integration )</span><span class="Normal">&quot;</span>
<span id="W1L152" class="LineNr">152 </span>
<span id="W1L153" class="LineNr">153 </span><span class="GruvboxBlue">BDEPEND</span>=<span class="Normal">&quot;</span>
<span id="W1L154" class="LineNr">154 </span><span class="String">  app-arch/xz-utils:0</span>
<span id="W1L155" class="LineNr">155 </span><span class="String">  dev-util/gperf</span>
<span id="W1L156" class="Folded">156 </span><span class="Folded">+-- 12 lines: &gt;=dev-util/meson-0.46-------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L168" class="LineNr">168 </span><span class="String">  dev-libs/libxslt:0</span>
<span id="W1L169" class="LineNr">169 </span><span class="String">  </span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">python_gen_any_dep </span><span class="Normal">'</span><span class="String">dev-python/jinja[${PYTHON_USEDEP}]</span><span class="Normal">'</span><span class="GruvboxAqua">)</span>
<span id="W1L170" class="LineNr">170 </span><span class="String">  </span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">python_gen_any_dep </span><span class="Normal">'</span><span class="String">dev-python/lxml[${PYTHON_USEDEP}]</span><span class="Normal">'</span><span class="GruvboxAqua">)</span>
<span id="W1L171" class="LineNr">171 </span><span class="Normal">&quot;</span>
<span id="W1L172" class="LineNr">172 </span>
<span id="W1L173" class="LineNr">173 </span><span class="GruvboxGreenBold">python_check_deps() {</span>
<span id="W1L174" class="LineNr">174 </span><span class="DiffChange">  </span><span class="DiffText">has_version </span><span class="GruvboxOrange DiffText">-b</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">dev-python/jinja[</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PYTHON_USEDEP</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">]</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange"> </span><span class="Normal DiffChange">&amp;&amp;</span><span class="DiffChange">                                                                                                                  </span>
<span id="W1L175" class="LineNr">175 </span><span class="DiffChange">  </span><span class="DiffText">has_version </span><span class="GruvboxOrange DiffText">-b</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">dev-python/lxml[</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PYTHON_USEDEP</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">]</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                      </span>
<span id="W1L176" class="LineNr">176 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L177" class="LineNr">177 </span>
<span id="W1L178" class="LineNr">178 </span><span class="GruvboxBlue">QA_FLAGS_IGNORED</span>=<span class="Normal">&quot;</span><span class="String">usr/lib/systemd/boot/efi/.*</span><span class="Normal">&quot;</span>
<span id="W1L179" class="LineNr">179 </span><span class="GruvboxBlue">QA_EXECSTACK</span>=<span class="Normal">&quot;</span><span class="String">usr/lib/systemd/boot/efi/*</span><span class="Normal">&quot;</span>
<span id="W1L180" class="LineNr">180 </span>
<span id="W1L181" class="LineNr">181 </span><span class="GruvboxGreenBold">pkg_pretend() {</span>
<span id="W1L182" class="LineNr">182 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">MERGE_TYPE</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="String">buildonly</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L183" class="LineNr">183 </span>    <span class="GruvboxRed">if </span>use <span class="GruvboxRed">test</span> <span class="Normal">&amp;&amp;</span> has pid-sandbox <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FEATURES</span><span class="GruvboxAqua">}</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L184" class="LineNr">184 </span>      ewarn <span class="Normal">&quot;</span><span class="String">Tests are known to fail with PID sandboxing enabled.</span><span class="Normal">&quot;</span>
<span id="W1L185" class="LineNr">185 </span>      ewarn <span class="Normal">&quot;</span><span class="String">See <a href="https://bugs.gentoo.org/674458.">https://bugs.gentoo.org/674458.</a></span><span class="Normal">&quot;</span>
<span id="W1L186" class="LineNr">186 </span>    <span class="GruvboxRed">fi</span>
<span id="W1L187" class="LineNr">187 </span>
<span id="W1L188" class="LineNr">188 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">local</span><span class="GruvboxBlue DiffChange"> CONFIG_CHECK</span><span class="Normal DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">~AUTOFS4_FS</span><span class="String DiffChange"> ~BINFMT_MISC ~BLK_DEV_BSG ~CGROUPS</span><span class="DiffChange">                                                                                                    </span>
<span id="W1L189" class="LineNr">189 </span><span class="String DiffChange">      ~DEVTMPFS ~EPOLL ~FANOTIFY ~FHANDLE</span><span class="DiffChange">                                                                                                                                 </span>
<span id="W1L190" class="LineNr">190 </span><span class="String">      ~INOTIFY_USER ~IPV6 ~NET ~NET_NS ~PROC_FS ~SIGNALFD ~SYSFS</span>
<span id="W1L191" class="LineNr">191 </span><span class="String">      ~TIMERFD ~TMPFS_XATTR ~UNIX ~USER_NS</span>
<span id="W1L192" class="LineNr">192 </span><span class="String">      ~CRYPTO_HMAC ~CRYPTO_SHA256 ~CRYPTO_USER_API_HASH</span>
<span id="W1L193" class="LineNr">193 </span><span class="String">      ~!GRKERNSEC_PROC ~!IDE ~!SYSFS_DEPRECATED</span>
<span id="W1L194" class="LineNr">194 </span><span class="String">      ~!SYSFS_DEPRECATED_V2</span><span class="Normal">&quot;</span>
<span id="W1L195" class="LineNr">195 </span>
<span id="W1L196" class="LineNr">196 </span>    use acl <span class="Normal">&amp;&amp;</span> CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~TMPFS_POSIX_ACL</span><span class="Normal">&quot;</span>
<span id="W1L197" class="LineNr">197 </span>    use seccomp <span class="Normal">&amp;&amp;</span> CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~SECCOMP ~SECCOMP_FILTER</span><span class="Normal">&quot;</span>
<span id="W1L198" class="LineNr">198 </span><span class="DiffAdd">    kernel_is </span><span class="GruvboxRed DiffAdd">-lt</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">3</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">7</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&amp;&amp;</span><span class="DiffAdd"> CONFIG_CHECK</span><span class="Normal DiffAdd">+=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"> ~HOTPLUG</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                        </span>
<span id="W1L199" class="LineNr">199 </span><span class="DiffAdd">    kernel_is </span><span class="GruvboxRed DiffAdd">-lt</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">4</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">7</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&amp;&amp;</span><span class="DiffAdd"> CONFIG_CHECK</span><span class="Normal DiffAdd">+=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"> ~DEVPTS_MULTIPLE_INSTANCES</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                      </span>
<span id="W1L200" class="LineNr">200 </span><span class="DiffAdd">    kernel_is </span><span class="GruvboxRed DiffAdd">-ge</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">4</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">10</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&amp;&amp;</span><span class="DiffAdd"> CONFIG_CHECK</span><span class="Normal DiffAdd">+=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"> ~CGROUP_BPF</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                    </span>
<span id="W1L201" class="LineNr">201 </span>
<span id="W1L202" class="LineNr">202 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">if </span><span class="DiffChange">kernel_is </span><span class="GruvboxRed DiffChange">-</span><span class="GruvboxRed DiffText">lt</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">5</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">10</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">20</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                                                        </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L203" class="LineNr">203 </span>      CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~CHECKPOINT_RESTORE</span><span class="Normal">&quot;</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L204" class="LineNr">204 </span>    <span class="GruvboxRed">else</span>
<span id="W1L205" class="LineNr">205 </span><span class="DiffChange">      CONFIG_CHECK</span><span class="Normal DiffChange">+=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange"> ~</span><span class="String DiffText">KCMP</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                              </span>
<span id="W1L206" class="LineNr">206 </span>    <span class="GruvboxRed">fi</span>
<span id="W1L207" class="LineNr">207 </span>
<span id="W1L208" class="LineNr">208 </span>    <span class="GruvboxRed">if </span>linux_config_exists<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L209" class="LineNr">209 </span>      <span class="GruvboxRed">local</span><span class="GruvboxBlue"> uevent_helper_path</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">linux_chkconfig_string UEVENT_HELPER_PATH</span><span class="GruvboxAqua">)</span>
<span id="W1L210" class="LineNr">210 </span>      <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxRed">-n</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">uevent_helper_path</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span> <span class="Normal">&amp;&amp;</span> <span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">uevent_helper_path</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="Normal">'</span><span class="String">&quot;&quot;</span><span class="Normal">'</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L211" class="LineNr">211 </span>        ewarn <span class="Normal">&quot;</span><span class="String">It's recommended to set an empty value to the following kernel config option:</span><span class="Normal">&quot;</span>
<span id="W1L212" class="Folded">212 </span><span class="Folded">+-- 19 lines: ewarn &quot;CONFIG_UEVENT_HELPER_PATH=${uevent_helper_path}&quot;---------------------------------------------------------------------------------------------------------</span>
<span id="W1L231" class="LineNr">231 </span><span class="GruvboxGreenBold">src_unpack() {</span>
<span id="W1L232" class="LineNr">232 </span>  default
<span id="W1L233" class="LineNr">233 </span>  <span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="GruvboxPurple">9999</span> <span class="GruvboxOrange">]]</span> <span class="Normal">||</span> git-r3_src_unpack
<span id="W1L234" class="LineNr">234 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L235" class="LineNr">235 </span>
<span id="W1L236" class="LineNr">236 </span><span class="GruvboxGreenBold">src_prepare() {</span>
<span id="W1L237" class="LineNr">237 </span><span class="DiffChange">  </span><span class="Comment DiffText"># Do NOT add patches here</span><span class="DiffChange">                                                                                                                                               </span>
<span id="W1L238" class="LineNr">238 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> PATCHES</span><span class="Normal DiffAdd">=</span><span class="GruvboxBlue DiffAdd">(</span><span class="DiffAdd">)</span><span class="DiffAdd">                                                                                                                                                        </span>
<span id="W1L239" class="LineNr">239 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L240" class="LineNr">240 </span><span class="DiffAdd">  </span><span class="GruvboxOrange DiffAdd">[[</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">-d</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">WORKDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd">/patches</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">]]</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&amp;&amp;</span><span class="DiffAdd"> PATCHES</span><span class="Normal DiffAdd">+=</span><span class="GruvboxAqua DiffAdd">(</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">WORKDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/patches </span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">                                                                                                      </span>
<span id="W1L241" class="LineNr">241 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L242" class="LineNr">242 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Add local patches here</span><span class="DiffAdd">                                                                                                                                                </span>
<span id="W1L243" class="LineNr">243 </span><span class="DiffAdd">  PATCHES</span><span class="Normal DiffAdd">+=</span><span class="DiffAdd">(</span><span class="DiffAdd">                                                                                                                                                              </span>
<span id="W1L244" class="LineNr">244 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: Adding our own patches here.</span><span class="DiffAdd">                                                                                                                               </span>
<span id="W1L245" class="LineNr">245 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0001-wait-online-set-any-by-default.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                               </span>
<span id="W1L246" class="LineNr">246 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0002-networkd-default-to-kernel-IPForwarding-setting.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                              </span>
<span id="W1L247" class="LineNr">247 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0003-needs-update-don-t-require-strictly-newer-usr.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                </span>
<span id="W1L248" class="LineNr">248 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0004-core-use-max-for-DefaultTasksMax.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L249" class="LineNr">249 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0005-systemd-Disable-SELinux-permissions-checks.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                   </span>
<span id="W1L250" class="LineNr">250 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0006-core-handle-lookup-paths-being-symlinks.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                      </span>
<span id="W1L251" class="LineNr">251 </span><span class="DiffAdd">    </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/0007-Revert-getty-Pass-tty-to-use-by-agetty-via-stdin.patch</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                             </span>
<span id="W1L252" class="LineNr">252 </span>  )
<span id="W1L253" class="LineNr">253 </span>
<span id="W1L254" class="LineNr">254 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use vanilla<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L255" class="LineNr">255 </span>    PATCHES<span class="Normal">+=</span>(
<span id="W1L256" class="LineNr">256 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-generator-path-r2.patch</span><span class="Normal">&quot;</span>
<span id="W1L257" class="LineNr">257 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-systemctl-disable-sysv-sync-r1.patch</span><span class="Normal">&quot;</span>
<span id="W1L258" class="LineNr">258 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-journald-audit.patch</span><span class="Normal">&quot;</span>
<span id="W1L259" class="LineNr">259 </span>    <span class="Error">)</span>
<span id="W1L260" class="LineNr">260 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L261" class="LineNr">261 </span>
<span id="W1L262" class="LineNr">262 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># F</span><span class="Comment DiffText">latcar: The Kubelet takes /etc/resolv.conf for, e.g.,</span><span class="DiffChange">                                                                                                                </span>
<span id="W1L263" class="LineNr">263 </span><span class="DiffChange">  </span><span class="Comment DiffText"># CoreDNS which has dnsPolicy &quot;default&quot;, but unless th</span><span class="Comment DiffChange">e</span><span class="DiffChange">                                                                                                                 </span>
<span id="W1L264" class="LineNr">264 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># kubelet --resolv-conf flag is set to point to</span><span class="DiffAdd">                                                                                                                         </span>
<span id="W1L265" class="LineNr">265 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># /run/systemd/resolve/resolv.conf this won't work with</span><span class="DiffAdd">                                                                                                                 </span>
<span id="W1L266" class="LineNr">266 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># /etc/resolv.conf pointing to</span><span class="DiffAdd">                                                                                                                                          </span>
<span id="W1L267" class="LineNr">267 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># /run/systemd/resolve/stub-resolv.conf which configures</span><span class="DiffAdd">                                                                                                                </span>
<span id="W1L268" class="LineNr">268 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># 127.0.0.53.  See</span><span class="DiffAdd">                                                                                                                                                      </span>
<span id="W1L269" class="LineNr">269 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># <a href="https://kubernetes.io/docs/tasks/administer-cluster/dns-debugging-resolution/#known-issues">https://kubernetes.io/docs/tasks/administer-cluster/dns-debugging-resolution/#known-issues</a></span><span class="DiffAdd">                                                                            </span>
<span id="W1L270" class="LineNr">270 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># This means that users who need split DNS to work should</span><span class="DiffAdd">                                                                                                               </span>
<span id="W1L271" class="LineNr">271 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># point /etc/resolv.conf back to</span><span class="DiffAdd">                                                                                                                                        </span>
<span id="W1L272" class="LineNr">272 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># /run/systemd/resolve/stub-resolv.conf (and if using K8s</span><span class="DiffAdd">                                                                                                               </span>
<span id="W1L273" class="LineNr">273 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># configure the kubelet resolvConf variable/--resolv-conf flag</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L274" class="LineNr">274 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># to /run/systemd/resolve/resolv.conf).</span><span class="DiffAdd">                                                                                                                                 </span>
<span id="W1L275" class="LineNr">275 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">sed</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">-i</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">-e</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">s,/run/systemd/resolve/stub-resolv.conf,/run/systemd/resolve/resolv.conf,</span><span class="Normal DiffAdd">'</span><span class="DiffAdd"> tmpfiles.d/systemd-resolve.conf </span><span class="Normal DiffAdd">||</span><span class="DiffAdd"> die</span><span class="DiffAdd">                                            </span>
<span id="W1L276" class="LineNr">276 </span>
<span id="W1L277" class="LineNr">277 </span>  default
<span id="W1L278" class="LineNr">278 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L279" class="LineNr">279 </span>
<span id="W1L280" class="LineNr">280 </span><span class="GruvboxGreenBold">src_configure() {</span>
<span id="W1L281" class="LineNr">281 </span>  <span class="Comment"># Prevent conflicts with i686 cross toolchain, bug 559726</span>
<span id="W1L282" class="LineNr">282 </span>  tc-export AR CC NM OBJCOPY RANLIB
<span id="W1L283" class="LineNr">283 </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L284" class="LineNr">284 </span>  python_setup
<span id="W1L285" class="LineNr">285 </span>
<span id="W1L286" class="LineNr">286 </span>  multilib-minimal_src_configure
<span id="W1L287" class="LineNr">287 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L288" class="LineNr">288 </span>
<span id="W1L289" class="LineNr">289 </span><span class="Comment DiffAdd"># Flatcar: Our function, we use it in some places below.</span><span class="DiffAdd">                                                                                                                  </span>
<span id="W1L290" class="LineNr">290 </span><span class="GruvboxGreenBold DiffAdd">get_rootprefix() {</span><span class="DiffAdd">                                                                                                                                                        </span>
<span id="W1L291" class="LineNr">291 </span><span class="DiffAdd">  usex split-usr </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">EPREFIX</span><span class="Normal DiffAdd">:-</span><span class="DiffAdd">/</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">EPREFIX</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/usr</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                         </span>
<span id="W1L292" class="LineNr">292 </span><span class="GruvboxGreenBold DiffAdd">}</span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L293" class="LineNr">293 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L294" class="LineNr">294 </span><span class="GruvboxGreenBold">multilib_src_configure() {</span>
<span id="W1L295" class="LineNr">295 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> myconf</span><span class="Normal">=</span><span class="GruvboxBlue">(</span>
<span id="W1L296" class="LineNr">296 </span>    <span class="GruvboxOrange">--localstatedir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/var</span><span class="Normal">&quot;</span>
<span id="W1L297" class="LineNr">297 </span><span class="DiffChange">    </span><span class="Comment DiffText"># Flatcar: Point to our user mailing list.</span><span class="DiffChange">                                                                                                                            </span>
<span id="W1L298" class="LineNr">298 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dsupport-url</span><span class="Normal DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"><a href="https://groups.google.com/forum/#!forum/flatcar-linux-user">https://groups.google.com/forum/#!forum/flatcar-linux-user</a></span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                            </span>
<span id="W1L299" class="LineNr">299 </span>    <span class="GruvboxOrange">-Dpamlibdir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">getpam_mod_dir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span id="W1L300" class="LineNr">300 </span>    <span class="Comment"># avoid bash-completion dep</span>
<span id="W1L301" class="LineNr">301 </span>    <span class="GruvboxOrange">-Dbashcompletiondir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">get_bashcompdir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span id="W1L302" class="LineNr">302 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># make sure we get /bin:/sbin in PATH</span><span class="DiffAdd">                                                                                                                                 </span>
<span id="W1L303" class="LineNr">303 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use split-usr</span><span class="GruvboxAqua">)</span>
<span id="W1L304" class="LineNr">304 </span><span class="DiffChange">    </span><span class="GruvboxOrange DiffText">-Dsplit-bin</span><span class="Normal DiffText">=</span><span class="GruvboxRed DiffText">true</span><span class="DiffChange">                                                                                                                                                      </span>
<span id="W1L305" class="LineNr">305 </span><span class="DiffChange">    </span><span class="GruvboxOrange DiffChange">-Drootprefix</span><span class="Normal DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">$(</span><span class="GruvboxOrange DiffText">get_rootprefix</span><span class="GruvboxAqua DiffChange">)</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                      </span>
<span id="W1L306" class="LineNr">306 </span>    <span class="GruvboxOrange">-Drootlibdir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/usr/</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">get_libdir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span id="W1L307" class="LineNr">307 </span>    <span class="Comment"># Avoid infinite exec recursion, bug 642724</span>
<span id="W1L308" class="LineNr">308 </span>    <span class="GruvboxOrange">-Dtelinit-path</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/lib/sysvinit/telinit</span><span class="Normal">&quot;</span>
<span id="W1L309" class="LineNr">309 </span>    <span class="Comment"># no deps</span>
<span id="W1L310" class="LineNr">310 </span>    <span class="GruvboxOrange">-Dima</span><span class="Normal">=</span><span class="GruvboxRed">true</span>
<span id="W1L311" class="LineNr">311 </span>    <span class="GruvboxOrange">-Ddefault-hierarchy</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">usex cgroup-hybrid hybrid unified</span><span class="GruvboxAqua">)</span>
<span id="W1L312" class="Folded">312 </span><span class="Folded">+-- 18 lines: Optional components/dependencies--------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L330" class="LineNr">330 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool importd bzip2</span><span class="GruvboxAqua">)</span>
<span id="W1L331" class="LineNr">331 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool importd zlib</span><span class="GruvboxAqua">)</span>
<span id="W1L332" class="LineNr">332 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool kmod</span><span class="GruvboxAqua">)</span>
<span id="W1L333" class="LineNr">333 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use lz4</span><span class="GruvboxAqua">)</span>
<span id="W1L334" class="LineNr">334 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use lzma xz</span><span class="GruvboxAqua">)</span>
<span id="W1L335" class="LineNr">335 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use zstd</span><span class="GruvboxAqua">)</span>
<span id="W1L336" class="LineNr">336 </span><span class="DiffChange">    </span><span class="GruvboxAqua DiffChange">$(</span><span class="GruvboxOrange DiffChange">meson_native_use_bool </span><span class="GruvboxOrange DiffText">nat</span><span class="GruvboxOrange DiffChange"> libiptc</span><span class="GruvboxAqua DiffChange">)</span><span class="DiffChange">                                                                                                                                  </span>
<span id="W1L337" class="LineNr">337 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool openssl</span><span class="GruvboxAqua">)</span>
<span id="W1L338" class="LineNr">338 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use pam</span><span class="GruvboxAqua">)</span>
<span id="W1L339" class="LineNr">339 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pkcs11 p11kit</span><span class="GruvboxAqua">)</span>
<span id="W1L340" class="LineNr">340 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pcre pcre2</span><span class="GruvboxAqua">)</span>
<span id="W1L341" class="LineNr">341 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool policykit polkit</span><span class="GruvboxAqua">)</span>
<span id="W1L342" class="LineNr">342 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pwquality</span><span class="GruvboxAqua">)</span>
<span id="W1L343" class="LineNr">343 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool qrcode qrencode</span><span class="GruvboxAqua">)</span>
<span id="W1L344" class="LineNr">344 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool seccomp</span><span class="GruvboxAqua">)</span>
<span id="W1L345" class="LineNr">345 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool selinux</span><span class="GruvboxAqua">)</span>
<span id="W1L346" class="LineNr">346 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool tpm tpm2</span><span class="GruvboxAqua">)</span>
<span id="W1L347" class="LineNr">347 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool </span><span class="GruvboxRed">test</span><span class="GruvboxOrange"> dbus</span><span class="GruvboxAqua">)</span>
<span id="W1L348" class="LineNr">348 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool xkb xkbcommon</span><span class="GruvboxAqua">)</span>
<span id="W1L349" class="LineNr">349 </span><span class="DiffChange">    </span><span class="Comment DiffText"># Flatcar: Use our ntp servers.</span><span class="DiffChange">                                                                                                                                       </span>
<span id="W1L350" class="LineNr">350 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dntp-servers</span><span class="Normal DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd">0.flatcar.pool.ntp.org 1.flatcar.pool.ntp.org 2.flatcar.pool.ntp.org 3.flatcar.pool.ntp.org</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                           </span>
<span id="W1L351" class="LineNr">351 </span>    <span class="Comment"># Breaks screen, tmux, etc.</span>
<span id="W1L352" class="LineNr">352 </span>    <span class="GruvboxOrange">-Ddefault-kill-user-processes</span><span class="Normal">=</span><span class="GruvboxRed">false</span>
<span id="W1L353" class="LineNr">353 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: </span><span class="Todo DiffAdd">TODO</span><span class="Comment DiffAdd">: Investigate if we want this.</span><span class="DiffAdd">                                                                                                                         </span>
<span id="W1L354" class="LineNr">354 </span>    <span class="GruvboxOrange">-Dcreate-log-dirs</span><span class="Normal">=</span><span class="GruvboxRed">false</span>
<span id="W1L355" class="LineNr">355 </span>
<span id="W1L356" class="LineNr">356 </span>    <span class="Comment"># multilib options</span>
<span id="W1L357" class="LineNr">357 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true backlight</span><span class="GruvboxAqua">)</span>
<span id="W1L358" class="LineNr">358 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true binfmt</span><span class="GruvboxAqua">)</span>
<span id="W1L359" class="LineNr">359 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true coredump</span><span class="GruvboxAqua">)</span>
<span id="W1L360" class="Folded">360 </span><span class="Folded">+-- 10 lines: $(meson_native_true environment-d)------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L370" class="LineNr">370 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true rfkill</span><span class="GruvboxAqua">)</span>
<span id="W1L371" class="LineNr">371 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true sysusers</span><span class="GruvboxAqua">)</span>
<span id="W1L372" class="LineNr">372 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true timedated</span><span class="GruvboxAqua">)</span>
<span id="W1L373" class="LineNr">373 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true timesyncd</span><span class="GruvboxAqua">)</span>
<span id="W1L374" class="LineNr">374 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true tmpfiles</span><span class="GruvboxAqua">)</span>
<span id="W1L375" class="LineNr">375 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true vconsole</span><span class="GruvboxAqua">)</span>
<span id="W1L376" class="LineNr">376 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L377" class="LineNr">377 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: Specify this, or meson breaks due to no</span><span class="DiffAdd">                                                                                                                    </span>
<span id="W1L378" class="LineNr">378 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># /etc/login.defs.</span><span class="DiffAdd">                                                                                                                                                    </span>
<span id="W1L379" class="LineNr">379 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dsystem-gid-max</span><span class="Normal DiffAdd">=</span><span class="GruvboxPurple DiffAdd">999</span><span class="DiffAdd">                                                                                                                                                  </span>
<span id="W1L380" class="LineNr">380 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dsystem-uid-max</span><span class="Normal DiffAdd">=</span><span class="GruvboxPurple DiffAdd">999</span><span class="DiffAdd">                                                                                                                                                  </span>
<span id="W1L381" class="LineNr">381 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L382" class="LineNr">382 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: DBus paths.</span><span class="DiffAdd">                                                                                                                                                </span>
<span id="W1L383" class="LineNr">383 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Ddbussessionservicedir</span><span class="Normal DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">EPREFIX</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/usr/share/dbus-1/services</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                        </span>
<span id="W1L384" class="LineNr">384 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Ddbussystemservicedir</span><span class="Normal DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">EPREFIX</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/usr/share/dbus-1/system-services</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                  </span>
<span id="W1L385" class="LineNr">385 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L386" class="LineNr">386 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: PAM config directory.</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L387" class="LineNr">387 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dpamconfdir</span><span class="Normal DiffAdd">=</span><span class="DiffAdd">/usr/share/pam.d</span><span class="DiffAdd">                                                                                                                                         </span>
<span id="W1L388" class="LineNr">388 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L389" class="LineNr">389 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: The CoreOS epoch, Mon Jul 1 00:00:00 UTC</span><span class="DiffAdd">                                                                                                                   </span>
<span id="W1L390" class="LineNr">390 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># 2013. Used by timesyncd as a sanity check for the</span><span class="DiffAdd">                                                                                                                   </span>
<span id="W1L391" class="LineNr">391 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># minimum acceptable time. Explicitly set to avoid</span><span class="DiffAdd">                                                                                                                    </span>
<span id="W1L392" class="LineNr">392 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># using the current build time.</span><span class="DiffAdd">                                                                                                                                       </span>
<span id="W1L393" class="LineNr">393 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dtime-epoch</span><span class="Normal DiffAdd">=</span><span class="GruvboxPurple DiffAdd">1372636800</span><span class="DiffAdd">                                                                                                                                               </span>
<span id="W1L394" class="LineNr">394 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L395" class="LineNr">395 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: No default name servers.</span><span class="DiffAdd">                                                                                                                                   </span>
<span id="W1L396" class="LineNr">396 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Ddns-servers</span><span class="Normal DiffAdd">=</span><span class="DiffAdd">                                                                                                                                                        </span>
<span id="W1L397" class="LineNr">397 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L398" class="LineNr">398 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: Disable the &quot;First Boot Wizard&quot;, it isn't</span><span class="DiffAdd">                                                                                                                  </span>
<span id="W1L399" class="LineNr">399 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># very applicable to us.</span><span class="DiffAdd">                                                                                                                                              </span>
<span id="W1L400" class="LineNr">400 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dfirstboot</span><span class="Normal DiffAdd">=</span><span class="GruvboxRed DiffAdd">false</span><span class="DiffAdd">                                                                                                                                                     </span>
<span id="W1L401" class="LineNr">401 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L402" class="LineNr">402 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: Set latest network interface naming scheme</span><span class="DiffAdd">                                                                                                                 </span>
<span id="W1L403" class="LineNr">403 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># for</span><span class="DiffAdd">                                                                                                                                                                 </span>
<span id="W1L404" class="LineNr">404 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># <a href="https://github.com/flatcar/Flatcar/issues/36">https://github.com/flatcar/Flatcar/issues/36</a></span><span class="DiffAdd">                                                                                                                        </span>
<span id="W1L405" class="LineNr">405 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Ddefault-net-naming-scheme</span><span class="Normal DiffAdd">=</span><span class="DiffAdd">latest</span><span class="DiffAdd">                                                                                                                                    </span>
<span id="W1L406" class="LineNr">406 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L407" class="LineNr">407 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># Flatcar: Unported options, still needed?</span><span class="DiffAdd">                                                                                                                            </span>
<span id="W1L408" class="LineNr">408 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Defi-cc</span><span class="Normal DiffAdd">=</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">tc-getCC</span><span class="GruvboxAqua DiffAdd">)</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                                                </span>
<span id="W1L409" class="LineNr">409 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dquotaon-path</span><span class="Normal DiffAdd">=</span><span class="DiffAdd">/usr/sbin/quotaon</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L410" class="LineNr">410 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-Dquotacheck-path</span><span class="Normal DiffAdd">=</span><span class="DiffAdd">/usr/sbin/quotacheck</span><span class="DiffAdd">                                                                                                                                </span>
<span id="W1L411" class="LineNr">411 </span>  )
<span id="W1L412" class="LineNr">412 </span>
<span id="W1L413" class="LineNr">413 </span>  meson_src_configure <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">myconf</span><span class="GruvboxAqua">[</span>@<span class="GruvboxAqua">]</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>
<span id="W1L414" class="LineNr">414 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L415" class="LineNr">415 </span>
<span id="W1L416" class="LineNr">416 </span><span class="GruvboxGreenBold">multilib_src_test() {</span>
<span id="W1L417" class="LineNr">417 </span>  <span class="GruvboxRed">unset</span><span class="GruvboxBlue"> DBUS_SESSION_BUS_ADDRESS XDG_RUNTIME_DIR</span>
<span id="W1L418" class="LineNr">418 </span>  meson_src_test
<span id="W1L419" class="LineNr">419 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L420" class="LineNr">420 </span>
<span id="W1L421" class="LineNr">421 </span><span class="GruvboxGreenBold">multilib_src_install_all() {</span>
<span id="W1L422" class="LineNr">422 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> rootprefix</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">usex split-usr </span><span class="Normal">''</span><span class="GruvboxOrange"> /usr</span><span class="GruvboxAqua">)</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L423" class="LineNr">423 </span>
<span id="W1L424" class="LineNr">424 </span>  <span class="Comment"># meson doesn't know about docdir</span>
<span id="W1L425" class="LineNr">425 </span>  <span class="GruvboxRed">mv</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/doc/<span class="GruvboxOrange">{</span>systemd,<span class="GruvboxAqua">${</span><span class="GruvboxAqua">PF</span><span class="GruvboxAqua">}</span><span class="GruvboxOrange">}</span> <span class="Normal">||</span> die
<span id="W1L426" class="LineNr">426 </span>
<span id="W1L427" class="LineNr">427 </span>  einstalldocs
<span id="W1L428" class="LineNr">428 </span><span class="DiffChange">  </span><span class="Comment DiffText"># Flatcar: Do not install sample nsswitch.conf, we don't</span><span class="DiffChange">                                                                                                                </span>
<span id="W1L429" class="LineNr">429 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># provide it.</span><span class="DiffAdd">                                                                                                                                                           </span>
<span id="W1L430" class="LineNr">430 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># dodoc &quot;${FILESDIR}&quot;/nsswitch.conf</span><span class="DiffAdd">                                                                                                                                     </span>
<span id="W1L431" class="LineNr">431 </span>
<span id="W1L432" class="LineNr">432 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use resolvconf<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L433" class="LineNr">433 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">rm</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">-f</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">ED</span><span class="GruvboxAqua DiffChange">}${</span><span class="GruvboxAqua DiffChange">rootprefix</span><span class="GruvboxAqua DiffChange">}</span><span class="Normal DiffText">&quot;</span><span class="DiffText">/sbin</span><span class="DiffChange">/resolvconf </span><span class="Normal DiffChange">||</span><span class="DiffChange"> die</span><span class="DiffChange">                                                                                                                     </span>
<span id="W1L434" class="LineNr">434 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L435" class="LineNr">435 </span>
<span id="W1L436" class="LineNr">436 </span>  <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/etc/init.d/README <span class="Normal">||</span> die
<span id="W1L437" class="LineNr">437 </span>  <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}${</span><span class="GruvboxAqua">rootprefix</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/lib/systemd/system-generators/systemd-sysv-generator <span class="Normal">||</span> die
<span id="W1L438" class="LineNr">438 </span>
<span id="W1L439" class="LineNr">439 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use sysv-utils<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L440" class="LineNr">440 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">rm</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">ED</span><span class="GruvboxAqua DiffChange">}${</span><span class="GruvboxAqua DiffChange">rootprefix</span><span class="GruvboxAqua DiffChange">}</span><span class="Normal DiffText">&quot;</span><span class="DiffText">/sbin</span><span class="DiffChange">/</span><span class="GruvboxOrange DiffChange">{</span><span class="DiffChange">halt,init,poweroff,reboot,runlevel,shutdown,telinit</span><span class="GruvboxOrange DiffChange">}</span><span class="DiffChange"> </span><span class="Normal DiffChange">||</span><span class="DiffChange"> die</span><span class="DiffChange">                                                                             </span>
<span id="W1L441" class="LineNr">441 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/man/man1/init.<span class="GruvboxPurple">1</span> <span class="Normal">||</span> die
<span id="W1L442" class="LineNr">442 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/man/man8/<span class="GruvboxOrange">{</span>halt,poweroff,reboot,runlevel,shutdown,telinit<span class="GruvboxOrange">}</span>.<span class="GruvboxPurple">8</span> <span class="Normal">||</span> die
<span id="W1L443" class="LineNr">443 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L444" class="LineNr">444 </span>
<span id="W1L445" class="LineNr">445 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffChange">if </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> use resolvconf </span><span class="Normal DiffChange">&amp;&amp;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> use sysv-utils</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                                           </span>
<span id="W1L446" class="LineNr">446 </span>    <span class="GruvboxRed">rmdir</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}${</span><span class="GruvboxAqua">rootprefix</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/sbin <span class="Normal">||</span> die
<span id="W1L447" class="LineNr">447 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L448" class="LineNr">448 </span>
<span id="W1L449" class="LineNr">449 </span>  <span class="Comment"># <a href="https://bugs.gentoo.org/761763">https://bugs.gentoo.org/761763</a></span>
<span id="W1L450" class="LineNr">450 </span>  <span class="GruvboxRed">rm</span> <span class="GruvboxOrange">-r</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/lib/sysusers.d <span class="Normal">||</span> die
<span id="W1L451" class="LineNr">451 </span>
<span id="W1L452" class="LineNr">452 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># </span><span class="Comment DiffText">Flatcar: Upstream uses keepdir commands to keep some empty</span><span class="DiffChange">                                                                                                            </span>
<span id="W1L453" class="LineNr">453 </span><span class="DiffChange">  </span><span class="Comment DiffText"># directories. We use tmpfiles.</span><span class="DiffChange">                                                                                                                                         </span>
<span id="W1L454" class="LineNr">454 </span><span class="DiffChange">  </span><span class="Comment DiffText"># # Preserve empty dirs in /etc &amp; /var, bug #437008</span><span class="DiffChange">                                                                                                                     </span>
<span id="W1L455" class="LineNr">455 </span><span class="DiffChange">  </span><span class="Comment DiffText"># keepdir /etc/{binfmt.d,modules-load.d,tmpfiles.d</span><span class="Comment DiffChange">}</span><span class="DiffChange">                                                                                                                     </span>
<span id="W1L456" class="LineNr">456 </span><span class="DiffChange">  </span><span class="Comment DiffText"># keepdir /etc/kernel/install</span><span class="Comment DiffChange">.d</span><span class="DiffChange">                                                                                                                                         </span>
<span id="W1L457" class="LineNr">457 </span><span class="DiffText">  </span><span class="Comment DiffText"># keepdir /etc/systemd/{network,system,user}</span><span class="DiffChange">                                                                                                                            </span>
<span id="W1L458" class="LineNr">458 </span><span class="DiffChange">  </span><span class="Comment DiffText"># keepdir /etc/udev/rules</span><span class="Comment DiffChange">.d</span><span class="DiffChange">                                                                                                                                             </span>
<span id="W1L459" class="LineNr">459 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                       </span>
<span id="W1L460" class="LineNr">460 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir /etc/udev/hwdb.d</span><span class="DiffAdd">                                                                                                                                              </span>
<span id="W1L461" class="LineNr">461 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                       </span>
<span id="W1L462" class="LineNr">462 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir &quot;${rootprefix}&quot;/lib/systemd/{system-sleep,system-shutdown}</span><span class="DiffAdd">                                                                                                    </span>
<span id="W1L463" class="LineNr">463 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir /usr/lib/{binfmt.d,modules-load.d}</span><span class="DiffAdd">                                                                                                                            </span>
<span id="W1L464" class="LineNr">464 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir /usr/lib/systemd/user-generators</span><span class="DiffAdd">                                                                                                                              </span>
<span id="W1L465" class="LineNr">465 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir /var/lib/systemd</span><span class="DiffAdd">                                                                                                                                              </span>
<span id="W1L466" class="LineNr">466 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># keepdir /var/log/journal</span><span class="DiffAdd">                                                                                                                                              </span>
<span id="W1L467" class="LineNr">467 </span>
<span id="W1L468" class="LineNr">468 </span><span class="DiffChange">  </span><span class="Comment DiffText"># Flatcar: No migrations happening here.</span><span class="DiffChange">                                                                                                                                </span>
<span id="W1L469" class="LineNr">469 </span><span class="DiffChange">  </span><span class="Comment DiffText"># # Symlink /etc/sysctl.conf for easy migration.</span><span class="DiffChange">                                                                                                                        </span>
<span id="W1L470" class="LineNr">470 </span><span class="DiffChange">  </span><span class="Comment DiffText"># dosym ../../../etc/sysctl.conf /usr/lib/sysctl.d/99-sysctl.conf</span><span class="DiffChange">                                                                                                       </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L471" class="LineNr">471 </span>
<span id="W1L472" class="LineNr">472 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># </span><span class="Comment DiffText">Flatcar: Do not install a pam policy, we have our ow</span><span class="Comment DiffChange">n.</span><span class="DiffChange">                                                                                                                </span>
<span id="W1L473" class="LineNr">473 </span><span class="DiffChange">  </span><span class="Comment DiffText"># if use pam; then</span><span class="DiffChange">                                                                                                                                                      </span>
<span id="W1L474" class="LineNr">474 </span><span class="DiffText">  </span><span class="Comment DiffText">#   newpamd &quot;${FILESDIR}&quot;/systemd-user.pam systemd-user</span><span class="DiffChange">                                                                                                                 </span>
<span id="W1L475" class="LineNr">475 </span><span class="DiffChange">  </span><span class="Comment DiffText"># fi</span><span class="DiffChange">                                                                                                                                                                    </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L476" class="LineNr">476 </span>
<span id="W1L477" class="LineNr">477 </span>  <span class="GruvboxRed">if </span>use split-usr<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L478" class="LineNr">478 </span>    <span class="Comment"># Avoid breaking boot/reboot</span>
<span id="W1L479" class="LineNr">479 </span>    dosym ../../../lib/systemd/systemd /usr/lib/systemd/systemd
<span id="W1L480" class="LineNr">480 </span>    dosym ../../../lib/systemd/systemd-shutdown /usr/lib/systemd/systemd-shutdown
<span id="W1L481" class="LineNr">481 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L482" class="LineNr">482 </span>
<span id="W1L483" class="LineNr">483 </span><span class="DiffChange">  </span><span class="Comment DiffText"># workaround for <a href="https://github.com/systemd/systemd/issues/13501">https://github.com/systemd/systemd/issues/13501</a></span><span class="DiffChange">                                                                                                        </span>
<span id="W1L484" class="LineNr">484 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">use hostnamed-fallback</span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                                         </span>
<span id="W1L485" class="LineNr">485 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># this file requires dbus-broker</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L486" class="LineNr">486 </span><span class="DiffAdd">    insinto /usr/share/dbus</span><span class="GruvboxRed DiffAdd">-1</span><span class="DiffAdd">/system.d/</span><span class="DiffAdd">                                                                                                                                   </span>
<span id="W1L487" class="LineNr">487 </span><span class="DiffAdd">    doins </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/org.freedesktop.hostname1_no_polkit.conf</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L488" class="LineNr">488 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L489" class="LineNr">489 </span><span class="DiffAdd">    insinto </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">rootprefix</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/lib/systemd/system/systemd-hostnamed.service.d/</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                               </span>
<span id="W1L490" class="LineNr">490 </span><span class="DiffAdd">    doins </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/00-hostnamed-network-user.conf</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                    </span>
<span id="W1L491" class="LineNr">491 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W1L492" class="LineNr">492 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L493" class="LineNr">493 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: gen_usr_ldscript is likely for static libs, so we</span><span class="DiffAdd">                                                                                                            </span>
<span id="W1L494" class="LineNr">494 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># dropped it.</span><span class="DiffAdd">                                                                                                                                                           </span>
<span id="W1L495" class="LineNr">495 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># gen_usr_ldscript -a systemd udev</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L496" class="LineNr">496 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L497" class="LineNr">497 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Ensure journal directory has correct ownership/mode</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L498" class="LineNr">498 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># in inital image.  This is fixed by systemd-tmpfiles *but*</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L499" class="LineNr">499 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># journald starts before that and will create the journal if</span><span class="DiffAdd">                                                                                                            </span>
<span id="W1L500" class="LineNr">500 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># the filesystem is already read-write.  Conveniently the</span><span class="DiffAdd">                                                                                                               </span>
<span id="W1L501" class="LineNr">501 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># systemd Makefile sets this up completely wrong.</span><span class="DiffAdd">                                                                                                                       </span>
<span id="W1L502" class="LineNr">502 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                       </span>
<span id="W1L503" class="LineNr">503 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: </span><span class="Todo DiffAdd">TODO</span><span class="Comment DiffAdd">: Is this still a problem?</span><span class="DiffAdd">                                                                                                                               </span>
<span id="W1L504" class="LineNr">504 </span><span class="DiffAdd">  dodir /var/log/journal</span><span class="DiffAdd">                                                                                                                                                  </span>
<span id="W1L505" class="LineNr">505 </span><span class="DiffAdd">  fowners root:systemd-journal /var/log/journal</span><span class="DiffAdd">                                                                                                                           </span>
<span id="W1L506" class="LineNr">506 </span><span class="DiffAdd">  fperms </span><span class="GruvboxPurple DiffAdd">2755</span><span class="DiffAdd"> /var/log/journal</span><span class="DiffAdd">                                                                                                                                            </span>
<span id="W1L507" class="LineNr">507 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L508" class="LineNr">508 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Don't prune systemd dirs.</span><span class="DiffAdd">                                                                                                                                    </span>
<span id="W1L509" class="LineNr">509 </span><span class="DiffAdd">  dotmpfiles </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/systemd-flatcar.conf</span><span class="DiffAdd">                                                                                                                           </span>
<span id="W1L510" class="LineNr">510 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Add tmpfiles rule for resolv.conf. This path has</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L511" class="LineNr">511 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># changed after v213 so it must be handled here instead of</span><span class="DiffAdd">                                                                                                              </span>
<span id="W1L512" class="LineNr">512 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># baselayout now.</span><span class="DiffAdd">                                                                                                                                                       </span>
<span id="W1L513" class="LineNr">513 </span><span class="DiffAdd">  dotmpfiles </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/systemd-resolv.conf</span><span class="DiffAdd">                                                                                                                            </span>
<span id="W1L514" class="LineNr">514 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L515" class="LineNr">515 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Don't default to graphical.target.</span><span class="DiffAdd">                                                                                                                           </span>
<span id="W1L516" class="LineNr">516 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> unitdir</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">builddir_systemd_get_systemunitdir</span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">                                                                                                                     </span>
<span id="W1L517" class="LineNr">517 </span><span class="DiffAdd">  dosym multi-user.target </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">unitdir</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/default.target</span><span class="DiffAdd">                                                                                                                     </span>
<span id="W1L518" class="LineNr">518 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L519" class="LineNr">519 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Don't set any extra environment variables by default.</span><span class="DiffAdd">                                                                                                        </span>
<span id="W1L520" class="LineNr">520 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">rm</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ED</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/usr/lib/environment.d/99-environment.conf</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">||</span><span class="DiffAdd"> die</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L521" class="LineNr">521 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L522" class="LineNr">522 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: These lines more or less follow the systemd's</span><span class="DiffAdd">                                                                                                                </span>
<span id="W1L523" class="LineNr">523 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># preset file (90-systemd.preset). We do it that way, to avoid</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L524" class="LineNr">524 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># putting symlinks in /etc. Please keep the lines in the same</span><span class="DiffAdd">                                                                                                           </span>
<span id="W1L525" class="LineNr">525 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># order as the &quot;enable&quot; lines appear in the preset file. For a</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L526" class="LineNr">526 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># single enable line in preset, there may be more lines if the</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L527" class="LineNr">527 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># unit file had Also: clause which has units we enable here</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L528" class="LineNr">528 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># too.</span><span class="DiffAdd">                                                                                                                                                                  </span>
<span id="W1L529" class="LineNr">529 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L530" class="LineNr">530 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable remote-fs.target</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W1L531" class="LineNr">531 </span><span class="DiffAdd">  builddir_systemd_enable_service multi-user.target remote-fs.target</span><span class="DiffAdd">                                                                                                      </span>
<span id="W1L532" class="LineNr">532 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable remote-cryptsetup.target</span><span class="DiffAdd">                                                                                                                              </span>
<span id="W1L533" class="LineNr">533 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">use cryptsetup</span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                                                 </span>
<span id="W1L534" class="LineNr">534 </span><span class="DiffAdd">    builddir_systemd_enable_service multi-user.target remote-cryptsetup.target</span><span class="DiffAdd">                                                                                            </span>
<span id="W1L535" class="LineNr">535 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W1L536" class="LineNr">536 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable machines.target</span><span class="DiffAdd">                                                                                                                                       </span>
<span id="W1L537" class="LineNr">537 </span><span class="DiffAdd">  builddir_systemd_enable_service multi-user.target machines.target</span><span class="DiffAdd">                                                                                                       </span>
<span id="W1L538" class="LineNr">538 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable getty@.service</span><span class="DiffAdd">                                                                                                                                        </span>
<span id="W1L539" class="LineNr">539 </span><span class="DiffAdd">  dodir </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">unitdir</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/getty.target.wants</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                                   </span>
<span id="W1L540" class="LineNr">540 </span><span class="DiffAdd">  dosym ../getty@.service </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">unitdir</span><span class="GruvboxAqua DiffAdd">}</span><span class="String DiffAdd">/getty.target.wants/getty@tty1.service</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                              </span>
<span id="W1L541" class="LineNr">541 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-timesyncd.service</span><span class="DiffAdd">                                                                                                                             </span>
<span id="W1L542" class="LineNr">542 </span><span class="DiffAdd">  builddir_systemd_enable_service sysinit.target systemd-timesyncd.service</span><span class="DiffAdd">                                                                                                </span>
<span id="W1L543" class="LineNr">543 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-networkd.service (Also: systemd-networkd.socket, systemd-networkd-wait-online.service)</span><span class="DiffAdd">                                                        </span>
<span id="W1L544" class="LineNr">544 </span><span class="DiffAdd">  builddir_systemd_enable_service multi-user.target systemd-networkd.service</span><span class="DiffAdd">                                                                                              </span>
<span id="W1L545" class="LineNr">545 </span><span class="DiffAdd">  builddir_systemd_enable_service sockets.target systemd-networkd.socket</span><span class="DiffAdd">                                                                                                  </span>
<span id="W1L546" class="LineNr">546 </span><span class="DiffAdd">  builddir_systemd_enable_service network-online.target systemd-networkd-wait-online.service</span><span class="DiffAdd">                                                                              </span>
<span id="W1L547" class="LineNr">547 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-network-generator.service</span><span class="DiffAdd">                                                                                                                     </span>
<span id="W1L548" class="LineNr">548 </span><span class="DiffAdd">  builddir_systemd_enable_service sysinit.target systemd-network-generator.service</span><span class="DiffAdd">                                                                                        </span>
<span id="W1L549" class="LineNr">549 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-resolved.service</span><span class="DiffAdd">                                                                                                                              </span>
<span id="W1L550" class="LineNr">550 </span><span class="DiffAdd">  builddir_systemd_enable_service multi-user.target systemd-resolved.service</span><span class="DiffAdd">                                                                                              </span>
<span id="W1L551" class="LineNr">551 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-homed.service (Also: systemd-userdbd.service [not enabled - has no WantedBy entry])</span><span class="DiffAdd">                                                           </span>
<span id="W1L552" class="LineNr">552 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">use homed</span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                                                      </span>
<span id="W1L553" class="LineNr">553 </span><span class="DiffAdd">    builddir_systemd_enable_service multi-user.target systemd-homed.target</span><span class="DiffAdd">                                                                                                </span>
<span id="W1L554" class="LineNr">554 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W1L555" class="LineNr">555 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-userdbd.socket</span><span class="DiffAdd">                                                                                                                                </span>
<span id="W1L556" class="LineNr">556 </span><span class="DiffAdd">  builddir_systemd_enable_service sockets.target systemd-userdbd.socket</span><span class="DiffAdd">                                                                                                   </span>
<span id="W1L557" class="LineNr">557 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-pstore.service</span><span class="DiffAdd">                                                                                                                                </span>
<span id="W1L558" class="LineNr">558 </span><span class="DiffAdd">  builddir_systemd_enable_service sysinit.target systemd-pstore.service</span><span class="DiffAdd">                                                                                                   </span>
<span id="W1L559" class="LineNr">559 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-boot-update.service</span><span class="DiffAdd">                                                                                                                           </span>
<span id="W1L560" class="LineNr">560 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">use gnuefi</span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                                                     </span>
<span id="W1L561" class="LineNr">561 </span><span class="DiffAdd">    builddir_systemd_enable_service sysinit.target systemd-boot-update.service</span><span class="DiffAdd">                                                                                            </span>
<span id="W1L562" class="LineNr">562 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W1L563" class="LineNr">563 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable reboot.target (not enabled - has no WantedBy</span><span class="DiffAdd">                                                                                                          </span>
<span id="W1L564" class="LineNr">564 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># entry)</span><span class="DiffAdd">                                                                                                                                                                </span>
<span id="W1L565" class="LineNr">565 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L566" class="LineNr">566 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: enable systemd-sysext.service by default</span><span class="DiffAdd">                                                                                                                     </span>
<span id="W1L567" class="LineNr">567 </span><span class="DiffAdd">  builddir_systemd_enable_service sysinit.target systemd-sysext.service</span><span class="DiffAdd">                                                                                                   </span>
<span id="W1L568" class="LineNr">568 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L569" class="LineNr">569 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Use an empty preset file, because systemctl</span><span class="DiffAdd">                                                                                                                  </span>
<span id="W1L570" class="LineNr">570 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># preset-all puts symlinks in /etc, not in /usr. We don't use</span><span class="DiffAdd">                                                                                                           </span>
<span id="W1L571" class="LineNr">571 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># /etc, because it is not autoupdated. We do the &quot;preset&quot; above.</span><span class="DiffAdd">                                                                                                        </span>
<span id="W1L572" class="LineNr">572 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">rm</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ED</span><span class="GruvboxAqua DiffAdd">}</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">usex split-usr </span><span class="Normal DiffAdd">''</span><span class="GruvboxOrange DiffAdd"> /usr</span><span class="GruvboxAqua DiffAdd">)</span><span class="String DiffAdd">/lib/systemd/system-preset/90-systemd.preset</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">||</span><span class="DiffAdd"> die</span><span class="DiffAdd">                                                                                  </span>
<span id="W1L573" class="LineNr">573 </span><span class="DiffAdd">  insinto </span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">usex split-usr </span><span class="Normal DiffAdd">''</span><span class="GruvboxOrange DiffAdd"> /usr</span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">/lib/systemd/system-preset</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L574" class="LineNr">574 </span><span class="DiffAdd">  doins </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/99-default.preset</span><span class="DiffAdd">                                                                                                                                   </span>
<span id="W1L575" class="LineNr">575 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L576" class="LineNr">576 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Flatcar: Do not ship distro-specific files (nsswitch.conf</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L577" class="LineNr">577 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># pam.d). This conflicts with our own configuration provided</span><span class="DiffAdd">                                                                                                            </span>
<span id="W1L578" class="LineNr">578 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># by baselayout.</span><span class="DiffAdd">                                                                                                                                                        </span>
<span id="W1L579" class="LineNr">579 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">rm</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">-rf</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ED</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/usr/share/factory</span><span class="DiffAdd">                                                                                                                                        </span>
<span id="W1L580" class="LineNr">580 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">sed</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">-i</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ED</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/usr/lib/tmpfiles.d/etc.conf \</span><span class="DiffAdd">                                                                                                                            </span>
<span id="W1L581" class="LineNr">581 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-e</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">/^C!* \/etc\/nsswitch\.conf/d</span><span class="Normal DiffAdd">'</span><span class="DiffAdd"> \</span><span class="DiffAdd">                                                                                                                                  </span>
<span id="W1L582" class="LineNr">582 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-e</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">/^C!* \/etc\/pam\.d/d</span><span class="Normal DiffAdd">'</span><span class="DiffAdd"> \</span><span class="DiffAdd">                                                                                                                                          </span>
<span id="W1L583" class="LineNr">583 </span><span class="DiffAdd">    </span><span class="GruvboxOrange DiffAdd">-e</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">/^C!* \/etc\/issue/d</span><span class="Normal DiffAdd">'</span><span class="DiffAdd">                                                                                                                                             </span>
<span id="W1L584" class="LineNr">584 </span><span class="GruvboxGreenBold DiffAdd">}</span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L585" class="LineNr">585 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L586" class="LineNr">586 </span><span class="Comment DiffAdd"># Flatcar: Our own version of systemd_get_systemunitdir, that returns</span><span class="DiffAdd">                                                                                                     </span>
<span id="W1L587" class="LineNr">587 </span><span class="Comment DiffAdd"># a path inside /usr, not /etc.</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W1L588" class="LineNr">588 </span><span class="GruvboxGreenBold DiffAdd">builddir_systemd_get_systemunitdir() {</span><span class="DiffAdd">                                                                                                                                    </span>
<span id="W1L589" class="LineNr">589 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">echo</span><span class="String DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">get_rootprefix</span><span class="GruvboxAqua DiffAdd">)</span><span class="String DiffAdd">/lib/systemd/system</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                             </span>
<span id="W1L590" class="LineNr">590 </span><span class="GruvboxGreenBold DiffAdd">}</span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L591" class="LineNr">591 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L592" class="LineNr">592 </span><span class="Comment DiffAdd"># Flatcar: Our own version of systemd_enable_service, that does</span><span class="DiffAdd">                                                                                                           </span>
<span id="W1L593" class="LineNr">593 </span><span class="Comment DiffAdd"># operations inside /usr, not /etc.</span><span class="DiffAdd">                                                                                                                                       </span>
<span id="W1L594" class="LineNr">594 </span><span class="GruvboxGreenBold DiffAdd">builddir_systemd_enable_service() {</span><span class="DiffAdd">                                                                                                                                       </span>
<span id="W1L595" class="LineNr">595 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> target</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">${1}</span><span class="DiffAdd">                                                                                                                                                       </span>
<span id="W1L596" class="LineNr">596 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> service</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">${2}</span><span class="DiffAdd">                                                                                                                                                      </span>
<span id="W1L597" class="LineNr">597 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> ud</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">builddir_systemd_get_systemunitdir</span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">                                                                                                                          </span>
<span id="W1L598" class="LineNr">598 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> destname</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">service</span><span class="Normal DiffAdd">##</span><span class="DiffAdd">*/</span><span class="GruvboxAqua DiffAdd">}</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W1L599" class="LineNr">599 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W1L600" class="LineNr">600 </span><span class="DiffAdd">  dodir </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ud</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">target</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">.wants </span><span class="Normal DiffAdd">&amp;&amp;</span><span class="DiffAdd"> \</span><span class="DiffAdd">                                                                                                                                    </span>
<span id="W1L601" class="LineNr">601 </span><span class="DiffAdd">  dosym ../</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">service</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">ud</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">target</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">.wants/</span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">destname</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                           </span>
<span id="W1L602" class="LineNr">602 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L603" class="LineNr">603 </span>
<span id="W1L604" class="LineNr">604 </span><span class="GruvboxGreenBold">migrate_locale() {</span>
<span id="W1L605" class="LineNr">605 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> envd_locale_def</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/etc/env.d/02locale</span><span class="Normal">&quot;</span>
<span id="W1L606" class="LineNr">606 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> envd_locale</span><span class="Normal">=</span><span class="GruvboxBlue">( </span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span><span class="GruvboxBlue">/etc/env.d/??locale </span>)
<span id="W1L607" class="LineNr">607 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> locale_conf</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/etc/locale.conf</span><span class="Normal">&quot;</span>
<span id="W1L608" class="Folded">608 </span><span class="Folded">+-- 37 lines: if [[ ! -L ${locale_conf} &amp;&amp; ! -e ${locale_conf} ]]; then-------------------------------------------------------------------------------------------------------</span>
<span id="W1L645" class="LineNr">645 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L646" class="LineNr">646 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L647" class="LineNr">647 </span>
<span id="W1L648" class="LineNr">648 </span><span class="GruvboxGreenBold">pkg_preinst() {</span>
<span id="W1L649" class="LineNr">649 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use split-usr<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L650" class="LineNr">650 </span>    <span class="GruvboxRed">local</span><span class="GruvboxBlue"> dir</span>
<span id="W1L651" class="LineNr">651 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">for</span><span class="DiffChange"> dir </span><span class="GruvboxRed DiffChange">in</span><span class="DiffChange"> bin sbin lib</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">do</span><span class="DiffChange">                                                                                                                                           </span>
<span id="W1L652" class="LineNr">652 </span><span class="DiffChange">      </span><span class="GruvboxRed DiffChange">if </span><span class="GruvboxOrange DiffChange">[[</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> </span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">dir</span><span class="GruvboxAqua DiffText">}</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">-ef</span><span class="DiffText"> </span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/usr</span><span class="String DiffChange">/</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">dir</span><span class="GruvboxAqua DiffChange">}</span><span class="DiffChange"> </span><span class="GruvboxOrange DiffChange">]]</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                            </span>
<span id="W1L653" class="LineNr">653 </span><span class="DiffChange">        eerror </span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">\&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">dir</span><span class="GruvboxAqua DiffText">}</span><span class="GruvboxOrange DiffText">\&quot;</span><span class="String DiffText"> and </span><span class="GruvboxOrange DiffText">\&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/usr/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">dir</span><span class="GruvboxAqua DiffText">}</span><span class="GruvboxOrange DiffText">\&quot;</span><span class="String DiffText"> are not merged</span><span class="String DiffChange">.</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                          </span>
<span id="W1L654" class="LineNr">654 </span><span class="DiffAdd">        eerror </span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd">One of them should be a symbolic link to the other one.</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                  </span>
<span id="W1L655" class="LineNr">655 </span>        <span class="GruvboxBlue">FAIL</span>=<span class="GruvboxPurple">1</span>
<span id="W1L656" class="LineNr">656 </span>      <span class="GruvboxRed">fi</span>
<span id="W1L657" class="LineNr">657 </span>    <span class="GruvboxRed">done</span>
<span id="W1L658" class="LineNr">658 </span>    <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FAIL</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L659" class="LineNr">659 </span>      eerror <span class="Normal">&quot;</span><span class="String">Migration to system layout with merged directories must be performed before</span><span class="Normal">&quot;</span>
<span id="W1L660" class="LineNr">660 </span><span class="DiffChange">      eerror </span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">rebuild</span><span class="String DiffChange">ing </span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">CATEGORY</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">/</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PN</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange"> with USE=</span><span class="GruvboxOrange DiffChange">\&quot;</span><span class="String DiffChange">-split-usr</span><span class="GruvboxOrange DiffChange">\&quot;</span><span class="String DiffChange"> to avoid run-time breakage.</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                           </span>
<span id="W1L661" class="LineNr">661 </span>      die <span class="Normal">&quot;</span><span class="String">System layout with split directories still used</span><span class="Normal">&quot;</span>
<span id="W1L662" class="LineNr">662 </span>    <span class="GruvboxRed">fi</span>
<span id="W1L663" class="LineNr">663 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L664" class="LineNr">664 </span><span class="GruvboxGreenBold">}</span>
<span id="W1L665" class="LineNr">665 </span>
<span id="W1L666" class="LineNr">666 </span><span class="GruvboxGreenBold">pkg_postinst() {</span>
<span id="W1L667" class="Folded">667 </span><span class="Folded">+--  6 lines: systemd_update_catalog------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W1L673" class="LineNr">673 </span>  udev_reload <span class="Normal">||</span> <span class="GruvboxBlue">FAIL</span>=<span class="GruvboxPurple">1</span>
<span id="W1L674" class="LineNr">674 </span>
<span id="W1L675" class="LineNr">675 </span>  <span class="Comment"># Bug 465468, make sure locales are respected, and ensure consistency</span>
<span id="W1L676" class="LineNr">676 </span>  <span class="Comment"># between OpenRC &amp; systemd</span>
<span id="W1L677" class="LineNr">677 </span>  migrate_locale
<span id="W1L678" class="LineNr">678 </span>
<span id="W1L679" class="LineNr">679 </span><span class="DiffChange">  </span><span class="Comment DiffText"># Flatcar: We enable getty and remote-fs targets in /usr</span><span class="DiffChange">                                                                                                                </span>
<span id="W1L680" class="LineNr">680 </span><span class="DiffChange">  </span><span class="Comment DiffText"># ourselves above.</span><span class="DiffChange">                                                                                                                                                      </span>
<span id="W1L681" class="LineNr">681 </span><span class="DiffChange">  </span><span class="Comment DiffText"># if [[ -z ${REPLACING_VERSIONS} ]]; then</span><span class="DiffChange">                                                                                                                               </span>
<span id="W1L682" class="LineNr">682 </span><span class="DiffChange">  </span><span class="Comment DiffText">#   if type systemctl &amp;&gt;/dev/null; then</span><span class="DiffChange">                                                                                                                                 </span>
<span id="W1L683" class="LineNr">683 </span><span class="DiffChange">  </span><span class="Comment DiffText">#     systemctl --root=&quot;${ROOT:-/}&quot; enable getty@.service remote-fs.target || FAIL=1</span><span class="DiffChange">                                                                                    </span>
<span id="W1L684" class="LineNr">684 </span><span class="DiffChange">  </span><span class="Comment DiffText">#   fi</span><span class="DiffChange">                                                                                                                                                                  </span>
<span id="W1L685" class="LineNr">685 </span><span class="DiffChange">  </span><span class="Comment DiffText">#   elog &quot;To enable a useful set of services, run the following:&quot;</span><span class="DiffChange">                                                                                                       </span>
<span id="W1L686" class="LineNr">686 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#   elog &quot;  systemctl preset-all --preset-mode=enable-only&quot;</span><span class="DiffAdd">                                                                                                             </span>
<span id="W1L687" class="LineNr">687 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># fi</span><span class="DiffAdd">                                                                                                                                                                    </span>
<span id="W1L688" class="LineNr">688 </span>
<span id="W1L689" class="LineNr">689 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxRed">-L</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/var/lib/systemd/timesync</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L690" class="LineNr">690 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/var/lib/systemd/timesync</span><span class="Normal">&quot;</span>
<span id="W1L691" class="LineNr">691 </span>  <span class="GruvboxRed">fi</span>
<span id="W1L692" class="LineNr">692 </span>
<span id="W1L693" class="LineNr">693 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FAIL</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W1L694" class="Folded">694 </span><span class="Folded">+-- 13 lines: eerror &quot;One of the postinst commands failed. Please check the postinst output&quot;----------------------------------------------------------------------------------</span>
</pre>
</div></td>
<td><div>
<pre>
<span id="W2L1" class="LineNr">  1 </span><span class="Comment"># Copyright 2011-2022 Gentoo Authors</span>
<span id="W2L2" class="LineNr">  2 </span><span class="Comment"># Distributed under the terms of the GNU General Public License v2</span>
<span id="W2L3" class="LineNr">  3 </span>
<span id="W2L4" class="LineNr">  4 </span><span class="GruvboxBlue">EAPI</span>=<span class="GruvboxPurple">7</span>
<span id="W2L5" class="LineNr">  5 </span><span class="GruvboxBlue DiffChange">PYTHON_COMPAT</span><span class="DiffChange">=</span><span class="GruvboxAqua DiffChange">(</span><span class="DiffChange"> python3_</span><span class="GruvboxOrange DiffChange">{</span><span class="GruvboxPurple DiffChange">8</span><span class="DiffChange">..</span><span class="GruvboxPurple DiffChange">1</span><span class="GruvboxPurple DiffText">1</span><span class="GruvboxOrange DiffChange">}</span><span class="DiffChange"> </span><span class="GruvboxAqua DiffChange">)</span><span class="DiffChange">                                                                                                                                         </span>
<span id="W2L6" class="LineNr">  6 </span>
<span id="W2L7" class="LineNr">  7 </span><span class="Comment"># Avoid QA warnings</span>
<span id="W2L8" class="LineNr">  8 </span><span class="GruvboxBlue">TMPFILES_OPTIONAL</span>=<span class="GruvboxPurple">1</span>
<span id="W2L9" class="LineNr">  9 </span><span class="GruvboxBlue DiffAdd">UDEV_OPTIONAL</span><span class="DiffAdd">=</span><span class="GruvboxPurple DiffAdd">1</span><span class="DiffAdd">                                                                                                                                                           </span>
<span id="W2L10" class="LineNr"> 10 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W2L11" class="LineNr"> 11 </span><span class="GruvboxBlue DiffAdd">QA_PKGCONFIG_VERSION</span><span class="DiffAdd">=</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">ver_cut </span><span class="GruvboxPurple DiffAdd">1</span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">                                                                                                                                         </span>
<span id="W2L12" class="LineNr"> 12 </span>
<span id="W2L13" class="LineNr"> 13 </span><span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">==</span> <span class="GruvboxPurple">9999</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L14" class="LineNr"> 14 </span>  <span class="GruvboxBlue">EGIT_REPO_URI</span>=<span class="Normal">&quot;</span><span class="String"><a href="https://github.com/systemd/systemd.git">https://github.com/systemd/systemd.git</a></span><span class="Normal">&quot;</span>
<span id="W2L15" class="LineNr"> 15 </span>  inherit git-r3
<span id="W2L16" class="LineNr"> 16 </span><span class="GruvboxRed">else</span>
<span id="W2L17" class="LineNr"> 17 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">==</span> <span class="String">*.*</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L18" class="Folded"> 18 </span><span class="Folded">+--  2 lines: MY_PN=systemd-stable--------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L20" class="LineNr"> 20 </span>    <span class="GruvboxBlue">MY_PN</span>=systemd
<span id="W2L21" class="LineNr"> 21 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L22" class="LineNr"> 22 </span>  <span class="GruvboxBlue">MY_PV</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="Normal">/</span>_<span class="Normal">/</span>-<span class="GruvboxAqua">}</span>
<span id="W2L23" class="LineNr"> 23 </span>  <span class="GruvboxBlue">MY_P</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PN</span><span class="GruvboxAqua">}</span>-<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PV</span><span class="GruvboxAqua">}</span>
<span id="W2L24" class="LineNr"> 24 </span>  <span class="GruvboxBlue">S</span>=<span class="GruvboxAqua">${</span><span class="GruvboxAqua">WORKDIR</span><span class="GruvboxAqua">}</span>/<span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_P</span><span class="GruvboxAqua">}</span>
<span id="W2L25" class="LineNr"> 25 </span>  <span class="GruvboxBlue">SRC_URI</span>=<span class="Normal">&quot;</span><span class="String"><a href="https://github.com/systemd/">https://github.com/systemd/</a></span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PN</span><span class="GruvboxAqua">}</span><span class="String">/archive/v</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_PV</span><span class="GruvboxAqua">}</span><span class="String">/</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MY_P</span><span class="GruvboxAqua">}</span><span class="String">.tar.gz</span><span class="Normal">&quot;</span>
<span id="W2L26" class="LineNr"> 26 </span><span class="DiffChange">  </span><span class="GruvboxBlue DiffText">KEYWORDS</span><span class="DiffText">=</span><span class="Normal DiffText">&quot;</span><span class="String DiffText">~alpha ~amd64 ~arm ~arm64 ~hppa ~ia64 ~loong ~m68k ~mips ~ppc ~ppc64 ~riscv ~s390 ~sparc ~x86</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">                                                                </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L27" class="LineNr"> 27 </span><span class="GruvboxRed">fi</span>
<span id="W2L28" class="LineNr"> 28 </span>
<span id="W2L29" class="LineNr"> 29 </span><span class="DiffText">inherit bash-completion-r1 flag-o-matic linux-info meson-multilib pam</span><span class="DiffChange">                                                                                                     </span>
<span id="W2L30" class="LineNr"> 30 </span><span class="DiffText">inherit python-any-r1 systemd toolchain-funcs udev usr-ldscript</span><span class="DiffChange">                                                                                                           </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L31" class="LineNr"> 31 </span>
<span id="W2L32" class="LineNr"> 32 </span><span class="GruvboxBlue">DESCRIPTION</span>=<span class="Normal">&quot;</span><span class="String">System and service manager for Linux</span><span class="Normal">&quot;</span>
<span id="W2L33" class="LineNr"> 33 </span><span class="GruvboxBlue DiffChange">HOMEPAGE</span><span class="DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">http</span><span class="String DiffText">://systemd.io/</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                             </span>
<span id="W2L34" class="LineNr"> 34 </span>
<span id="W2L35" class="LineNr"> 35 </span><span class="GruvboxBlue">LICENSE</span>=<span class="Normal">&quot;</span><span class="String">GPL-2 LGPL-2.1 MIT public-domain</span><span class="Normal">&quot;</span>
<span id="W2L36" class="LineNr"> 36 </span><span class="GruvboxBlue">SLOT</span>=<span class="Normal">&quot;</span><span class="String">0/2</span><span class="Normal">&quot;</span>
<span id="W2L37" class="LineNr"> 37 </span><span class="GruvboxBlue">IUSE</span>=<span class="Normal">&quot;</span>
<span id="W2L38" class="LineNr"> 38 </span><span class="String DiffChange">  acl apparmor audit cgroup-hybrid cryptsetup curl +dns-over-tls elfutils</span><span class="DiffChange">                                                                                                 </span>
<span id="W2L39" class="LineNr"> 39 </span><span class="String DiffChange">  fido2 +gcrypt gnuefi gnutls homed h</span><span class="String DiffText">ttp idn importd iptables</span><span class="String DiffChange"> +kmod</span><span class="DiffChange">                                                                                                       </span>
<span id="W2L40" class="LineNr"> 40 </span><span class="String DiffChange">  +lz4 lzma +openssl pam pcre pkcs11 policykit pwquality qrcode</span><span class="DiffChange">                                                                                                           </span>
<span id="W2L41" class="LineNr"> 41 </span><span class="String">  +resolvconf +seccomp selinux split-usr +sysv-utils test tpm vanilla xkb +zstd</span>
<span id="W2L42" class="LineNr"> 42 </span><span class="Normal">&quot;</span>
<span id="W2L43" class="LineNr"> 43 </span><span class="GruvboxBlue">REQUIRED_USE</span>=<span class="Normal">&quot;</span>
<span id="W2L44" class="LineNr"> 44 </span><span class="String">  dns-over-tls? ( || ( gnutls openssl ) )</span>
<span id="W2L45" class="LineNr"> 45 </span><span class="String">  homed? ( cryptsetup pam openssl )</span>
<span id="W2L46" class="LineNr"> 46 </span><span class="String">  importd? ( curl lzma || ( gcrypt openssl ) )</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L47" class="LineNr"> 47 </span><span class="String">  pwquality? ( homed )</span>
<span id="W2L48" class="LineNr"> 48 </span><span class="Normal">&quot;</span>
<span id="W2L49" class="LineNr"> 49 </span><span class="GruvboxBlue">RESTRICT</span>=<span class="Normal">&quot;</span><span class="String">!test? ( test )</span><span class="Normal">&quot;</span>
<span id="W2L50" class="LineNr"> 50 </span>
<span id="W2L51" class="LineNr"> 51 </span><span class="GruvboxBlue DiffChange">MINKV</span><span class="DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">4.15</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                                              </span>
<span id="W2L52" class="LineNr"> 52 </span>
<span id="W2L53" class="LineNr"> 53 </span><span class="GruvboxBlue">COMMON_DEPEND</span>=<span class="Normal">&quot;</span>
<span id="W2L54" class="LineNr"> 54 </span><span class="String">  &gt;=sys-apps/util-linux-2.30:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W2L55" class="LineNr"> 55 </span><span class="String">  sys-libs/libcap:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W2L56" class="LineNr"> 56 </span><span class="String">  virtual/libcrypt:=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">]</span>
<span id="W2L57" class="LineNr"> 57 </span><span class="String">  acl? ( sys-apps/acl:0= )</span>
<span id="W2L58" class="Folded"> 58 </span><span class="Folded">+-- 11 lines: apparmor? ( sys-libs/libapparmor:0= )---------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L69" class="LineNr"> 69 </span><span class="String">    app-arch/bzip2:0=</span>
<span id="W2L70" class="LineNr"> 70 </span><span class="String">    sys-libs/zlib:0=</span>
<span id="W2L71" class="LineNr"> 71 </span><span class="String">  )</span>
<span id="W2L72" class="LineNr"> 72 </span><span class="String">  kmod? ( &gt;=sys-apps/kmod-15:0= )</span>
<span id="W2L73" class="LineNr"> 73 </span><span class="String">  lz4? ( &gt;=app-arch/lz4-0_p131:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W2L74" class="LineNr"> 74 </span><span class="String">  lzma? ( &gt;=app-arch/xz-utils-5.0.5-r1:0=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W2L75" class="LineNr"> 75 </span><span class="String DiffChange">  </span><span class="String DiffText">iptables</span><span class="String DiffChange">? ( net-firewall/iptables:0= )</span><span class="DiffChange">                                                                                                                                  </span>
<span id="W2L76" class="LineNr"> 76 </span><span class="String">  openssl? ( &gt;=dev-libs/openssl-1.1.0:0= )</span>
<span id="W2L77" class="LineNr"> 77 </span><span class="String">  pam? ( sys-libs/pam:=[</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">MULTILIB_USEDEP</span><span class="GruvboxAqua">}</span><span class="String">] )</span>
<span id="W2L78" class="LineNr"> 78 </span><span class="String">  pkcs11? ( app-crypt/p11-kit:0= )</span>
<span id="W2L79" class="LineNr"> 79 </span><span class="String">  pcre? ( dev-libs/libpcre2 )</span>
<span id="W2L80" class="LineNr"> 80 </span><span class="String">  pwquality? ( dev-libs/libpwquality:0= )</span>
<span id="W2L81" class="LineNr"> 81 </span><span class="String">  qrcode? ( media-gfx/qrencode:0= )</span>
<span id="W2L82" class="Folded"> 82 </span><span class="Folded">+-- 36 lines: seccomp? ( &gt;=sys-libs/libseccomp-2.3.3:0= )---------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L118" class="LineNr">118 </span><span class="String">  &gt;=acct-user/systemd-coredump-0-r1</span>
<span id="W2L119" class="LineNr">119 </span><span class="String">  &gt;=acct-user/systemd-network-0-r1</span>
<span id="W2L120" class="LineNr">120 </span><span class="String">  acct-user/systemd-oom</span>
<span id="W2L121" class="LineNr">121 </span><span class="String">  &gt;=acct-user/systemd-resolve-0-r1</span>
<span id="W2L122" class="LineNr">122 </span><span class="String">  &gt;=acct-user/systemd-timesync-0-r1</span>
<span id="W2L123" class="LineNr">123 </span><span class="String">  &gt;=sys-apps/baselayout-2.2</span>
<span id="W2L124" class="LineNr">124 </span><span class="String DiffChange">  </span><span class="String DiffText">selinux</span><span class="String DiffChange">? (</span><span class="DiffChange">                                                                                                                                                              </span>
<span id="W2L125" class="LineNr">125 </span><span class="String DiffChange">    </span><span class="String DiffText">sec-policy/selinux-base-policy[systemd]</span><span class="DiffChange">                                                                                                                               </span>
<span id="W2L126" class="LineNr">126 </span><span class="String DiffChange">    s</span><span class="String DiffText">ec-policy/selinux-ntp</span><span class="DiffChange">                                                                                                                                                </span>
<span id="W2L127" class="LineNr">127 </span><span class="String">  )</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L128" class="LineNr">128 </span><span class="String">  sysv-utils? (</span>
<span id="W2L129" class="LineNr">129 </span><span class="String">    !sys-apps/openrc[sysv-utils(-)]</span>
<span id="W2L130" class="LineNr">130 </span><span class="String">    !sys-apps/sysvinit</span>
<span id="W2L131" class="LineNr">131 </span><span class="String">  )</span>
<span id="W2L132" class="LineNr">132 </span><span class="String">  !sysv-utils? ( sys-apps/sysvinit )</span>
<span id="W2L133" class="LineNr">133 </span><span class="String">  resolvconf? ( !net-dns/openresolv )</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L134" class="LineNr">134 </span><span class="String">  !sys-apps/hwids[udev]</span>
<span id="W2L135" class="LineNr">135 </span><span class="String">  !sys-auth/nss-myhostname</span>
<span id="W2L136" class="LineNr">136 </span><span class="String">  !sys-fs/eudev</span>
<span id="W2L137" class="LineNr">137 </span><span class="String">  !sys-fs/udev</span>
<span id="W2L138" class="LineNr">138 </span><span class="Normal">&quot;</span>
<span id="W2L139" class="LineNr">139 </span>
<span id="W2L140" class="LineNr">140 </span><span class="Comment"># sys-apps/dbus: the daemon only (+ build-time lib dep for tests)</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L141" class="LineNr">141 </span><span class="GruvboxBlue">PDEPEND</span>=<span class="Normal">&quot;</span><span class="String">&gt;=sys-apps/dbus-1.9.8[systemd]</span>
<span id="W2L142" class="LineNr">142 </span><span class="String DiffAdd">  &gt;=sys-fs/udev-init-scripts-34</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W2L143" class="LineNr">143 </span><span class="String">  policykit? ( sys-auth/polkit )</span>
<span id="W2L144" class="LineNr">144 </span><span class="String">  !vanilla? ( sys-apps/gentoo-systemd-integration )</span><span class="Normal">&quot;</span>
<span id="W2L145" class="LineNr">145 </span>
<span id="W2L146" class="LineNr">146 </span><span class="GruvboxBlue">BDEPEND</span>=<span class="Normal">&quot;</span>
<span id="W2L147" class="LineNr">147 </span><span class="String">  app-arch/xz-utils:0</span>
<span id="W2L148" class="LineNr">148 </span><span class="String">  dev-util/gperf</span>
<span id="W2L149" class="Folded">149 </span><span class="Folded">+-- 12 lines: &gt;=dev-util/meson-0.46-------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L161" class="LineNr">161 </span><span class="String">  dev-libs/libxslt:0</span>
<span id="W2L162" class="LineNr">162 </span><span class="String">  </span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">python_gen_any_dep </span><span class="Normal">'</span><span class="String">dev-python/jinja[${PYTHON_USEDEP}]</span><span class="Normal">'</span><span class="GruvboxAqua">)</span>
<span id="W2L163" class="LineNr">163 </span><span class="String">  </span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">python_gen_any_dep </span><span class="Normal">'</span><span class="String">dev-python/lxml[${PYTHON_USEDEP}]</span><span class="Normal">'</span><span class="GruvboxAqua">)</span>
<span id="W2L164" class="LineNr">164 </span><span class="Normal">&quot;</span>
<span id="W2L165" class="LineNr">165 </span>
<span id="W2L166" class="LineNr">166 </span><span class="GruvboxGreenBold">python_check_deps() {</span>
<span id="W2L167" class="LineNr">167 </span><span class="DiffChange">  </span><span class="DiffText">python_has_version</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">dev-python/jinja[</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PYTHON_USEDEP</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">]</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange"> </span><span class="Normal DiffChange">&amp;&amp;</span><span class="DiffChange">                                                                                                              </span>
<span id="W2L168" class="LineNr">168 </span><span class="DiffChange">  </span><span class="DiffText">python_has_version</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange">dev-python/lxml[</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PYTHON_USEDEP</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">]</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                  </span>
<span id="W2L169" class="LineNr">169 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L170" class="LineNr">170 </span>
<span id="W2L171" class="LineNr">171 </span><span class="GruvboxBlue">QA_FLAGS_IGNORED</span>=<span class="Normal">&quot;</span><span class="String">usr/lib/systemd/boot/efi/.*</span><span class="Normal">&quot;</span>
<span id="W2L172" class="LineNr">172 </span><span class="GruvboxBlue">QA_EXECSTACK</span>=<span class="Normal">&quot;</span><span class="String">usr/lib/systemd/boot/efi/*</span><span class="Normal">&quot;</span>
<span id="W2L173" class="LineNr">173 </span>
<span id="W2L174" class="LineNr">174 </span><span class="GruvboxGreenBold">pkg_pretend() {</span>
<span id="W2L175" class="LineNr">175 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">MERGE_TYPE</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="String">buildonly</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L176" class="LineNr">176 </span>    <span class="GruvboxRed">if </span>use <span class="GruvboxRed">test</span> <span class="Normal">&amp;&amp;</span> has pid-sandbox <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FEATURES</span><span class="GruvboxAqua">}</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L177" class="LineNr">177 </span>      ewarn <span class="Normal">&quot;</span><span class="String">Tests are known to fail with PID sandboxing enabled.</span><span class="Normal">&quot;</span>
<span id="W2L178" class="LineNr">178 </span>      ewarn <span class="Normal">&quot;</span><span class="String">See <a href="https://bugs.gentoo.org/674458.">https://bugs.gentoo.org/674458.</a></span><span class="Normal">&quot;</span>
<span id="W2L179" class="LineNr">179 </span>    <span class="GruvboxRed">fi</span>
<span id="W2L180" class="LineNr">180 </span>
<span id="W2L181" class="LineNr">181 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">local</span><span class="GruvboxBlue DiffChange"> CONFIG_CHECK</span><span class="Normal DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange"> ~BINFMT_MISC ~BLK_DEV_BSG ~CGROUPS</span><span class="DiffChange">                                                                                                               </span>
<span id="W2L182" class="LineNr">182 </span><span class="String DiffChange">      ~</span><span class="String DiffText">CGROUP_BPF ~</span><span class="String DiffChange">DEVTMPFS ~EPOLL ~FANOTIFY ~FHANDLE</span><span class="DiffChange">                                                                                                                     </span>
<span id="W2L183" class="LineNr">183 </span><span class="String">      ~INOTIFY_USER ~IPV6 ~NET ~NET_NS ~PROC_FS ~SIGNALFD ~SYSFS</span>
<span id="W2L184" class="LineNr">184 </span><span class="String">      ~TIMERFD ~TMPFS_XATTR ~UNIX ~USER_NS</span>
<span id="W2L185" class="LineNr">185 </span><span class="String">      ~CRYPTO_HMAC ~CRYPTO_SHA256 ~CRYPTO_USER_API_HASH</span>
<span id="W2L186" class="LineNr">186 </span><span class="String">      ~!GRKERNSEC_PROC ~!IDE ~!SYSFS_DEPRECATED</span>
<span id="W2L187" class="LineNr">187 </span><span class="String">      ~!SYSFS_DEPRECATED_V2</span><span class="Normal">&quot;</span>
<span id="W2L188" class="LineNr">188 </span>
<span id="W2L189" class="LineNr">189 </span>    use acl <span class="Normal">&amp;&amp;</span> CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~TMPFS_POSIX_ACL</span><span class="Normal">&quot;</span>
<span id="W2L190" class="LineNr">190 </span>    use seccomp <span class="Normal">&amp;&amp;</span> CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~SECCOMP ~SECCOMP_FILTER</span><span class="Normal">&quot;</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L191" class="LineNr">191 </span>
<span id="W2L192" class="LineNr">192 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">if </span><span class="DiffChange">kernel_is </span><span class="GruvboxRed DiffChange">-</span><span class="GruvboxRed DiffText">ge</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">5</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">10</span><span class="DiffChange"> </span><span class="GruvboxPurple DiffChange">20</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                                                        </span>
<span id="W2L193" class="LineNr">193 </span><span class="DiffAdd">      CONFIG_CHECK</span><span class="Normal DiffAdd">+=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"> ~KCMP</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                                              </span>
<span id="W2L194" class="LineNr">194 </span><span class="DiffAdd">    </span><span class="GruvboxRed DiffAdd">else</span><span class="DiffAdd">                                                                                                                                                                  </span>
<span id="W2L195" class="LineNr">195 </span>      CONFIG_CHECK<span class="Normal">+=</span><span class="Normal">&quot;</span><span class="String"> ~CHECKPOINT_RESTORE</span><span class="Normal">&quot;</span>
<span id="W2L196" class="LineNr">196 </span><span class="DiffAdd">    </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                    </span>
<span id="W2L197" class="LineNr">197 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W2L198" class="LineNr">198 </span><span class="DiffAdd">    </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">kernel_is </span><span class="GruvboxRed DiffAdd">-ge</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">4</span><span class="DiffAdd"> </span><span class="GruvboxPurple DiffAdd">18</span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                                           </span>
<span id="W2L199" class="LineNr">199 </span><span class="DiffAdd">      CONFIG_CHECK</span><span class="Normal DiffAdd">+=</span><span class="Normal DiffAdd">&quot;</span><span class="String DiffAdd"> ~AUTOFS_FS</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">                                                                                                                                         </span>
<span id="W2L200" class="LineNr">200 </span>    <span class="GruvboxRed">else</span>
<span id="W2L201" class="LineNr">201 </span><span class="DiffChange">      CONFIG_CHECK</span><span class="Normal DiffChange">+=</span><span class="Normal DiffChange">&quot;</span><span class="String DiffChange"> ~</span><span class="String DiffText">AUTOFS4_FS</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                                        </span>
<span id="W2L202" class="LineNr">202 </span>    <span class="GruvboxRed">fi</span>
<span id="W2L203" class="LineNr">203 </span>
<span id="W2L204" class="LineNr">204 </span>    <span class="GruvboxRed">if </span>linux_config_exists<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L205" class="LineNr">205 </span>      <span class="GruvboxRed">local</span><span class="GruvboxBlue"> uevent_helper_path</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">linux_chkconfig_string UEVENT_HELPER_PATH</span><span class="GruvboxAqua">)</span>
<span id="W2L206" class="LineNr">206 </span>      <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxRed">-n</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">uevent_helper_path</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span> <span class="Normal">&amp;&amp;</span> <span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">uevent_helper_path</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="Normal">'</span><span class="String">&quot;&quot;</span><span class="Normal">'</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L207" class="LineNr">207 </span>        ewarn <span class="Normal">&quot;</span><span class="String">It's recommended to set an empty value to the following kernel config option:</span><span class="Normal">&quot;</span>
<span id="W2L208" class="Folded">208 </span><span class="Folded">+-- 19 lines: ewarn &quot;CONFIG_UEVENT_HELPER_PATH=${uevent_helper_path}&quot;---------------------------------------------------------------------------------------------------------</span>
<span id="W2L227" class="LineNr">227 </span><span class="GruvboxGreenBold">src_unpack() {</span>
<span id="W2L228" class="LineNr">228 </span>  default
<span id="W2L229" class="LineNr">229 </span>  <span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">PV</span><span class="GruvboxAqua">}</span> <span class="GruvboxRed">!=</span> <span class="GruvboxPurple">9999</span> <span class="GruvboxOrange">]]</span> <span class="Normal">||</span> git-r3_src_unpack
<span id="W2L230" class="LineNr">230 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L231" class="LineNr">231 </span>
<span id="W2L232" class="LineNr">232 </span><span class="GruvboxGreenBold">src_prepare() {</span>
<span id="W2L233" class="LineNr">233 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffText">local</span><span class="GruvboxBlue DiffText"> PATCHES</span><span class="Normal DiffText">=</span><span class="GruvboxBlue DiffText">(</span><span class="DiffChange">                                                                                                                                                         </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L234" class="LineNr">234 </span>  )
<span id="W2L235" class="LineNr">235 </span>
<span id="W2L236" class="LineNr">236 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use vanilla<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L237" class="LineNr">237 </span>    PATCHES<span class="Normal">+=</span>(
<span id="W2L238" class="LineNr">238 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-generator-path-r2.patch</span><span class="Normal">&quot;</span>
<span id="W2L239" class="LineNr">239 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-systemctl-disable-sysv-sync-r1.patch</span><span class="Normal">&quot;</span>
<span id="W2L240" class="LineNr">240 </span>      <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">FILESDIR</span><span class="GruvboxAqua">}</span><span class="String">/gentoo-journald-audit.patch</span><span class="Normal">&quot;</span>
<span id="W2L241" class="LineNr">241 </span>    <span class="Error">)</span>
<span id="W2L242" class="LineNr">242 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L243" class="LineNr">243 </span>
<span id="W2L244" class="LineNr">244 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># F</span><span class="Comment DiffText">ails with split-usr.</span><span class="DiffChange">                                                                                                                                                 </span>
<span id="W2L245" class="LineNr">245 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffText">sed</span><span class="DiffText"> </span><span class="GruvboxOrange DiffText">-i</span><span class="DiffText"> </span><span class="GruvboxOrange DiffText">-e</span><span class="DiffText"> </span><span class="Normal DiffText">'</span><span class="String DiffText">2i exit 77</span><span class="Normal DiffText">'</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">test</span><span class="DiffText">/test-rpm-macros.sh </span><span class="Normal DiffText">||</span><span class="DiffText"> di</span><span class="DiffChange">e</span><span class="DiffChange">                                                                                                                   </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L246" class="LineNr">246 </span>
<span id="W2L247" class="LineNr">247 </span>  default
<span id="W2L248" class="LineNr">248 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L249" class="LineNr">249 </span>
<span id="W2L250" class="LineNr">250 </span><span class="GruvboxGreenBold">src_configure() {</span>
<span id="W2L251" class="LineNr">251 </span>  <span class="Comment"># Prevent conflicts with i686 cross toolchain, bug 559726</span>
<span id="W2L252" class="LineNr">252 </span>  tc-export AR CC NM OBJCOPY RANLIB
<span id="W2L253" class="LineNr">253 </span>
<span id="W2L254" class="LineNr">254 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Broken with FORTIFY_SOURCE=3: bug #841770.</span><span class="DiffAdd">                                                                                                                            </span>
<span id="W2L255" class="LineNr">255 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                       </span>
<span id="W2L256" class="LineNr">256 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># Our toolchain sets F_S=2 by default w/ &gt;= -O2, so we need</span><span class="DiffAdd">                                                                                                             </span>
<span id="W2L257" class="LineNr">257 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># to unset F_S first, then explicitly set 2, to negate any default</span><span class="DiffAdd">                                                                                                      </span>
<span id="W2L258" class="LineNr">258 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># and anything set by the user if they're choosing 3 (or if they've</span><span class="DiffAdd">                                                                                                     </span>
<span id="W2L259" class="LineNr">259 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd"># modified GCC to set 3).</span><span class="DiffAdd">                                                                                                                                               </span>
<span id="W2L260" class="LineNr">260 </span><span class="DiffAdd">  </span><span class="Comment DiffAdd">#</span><span class="DiffAdd">                                                                                                                                                                       </span>
<span id="W2L261" class="LineNr">261 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">if </span><span class="DiffAdd">is-flagq </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">-O[23]</span><span class="Normal DiffAdd">'</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">||</span><span class="DiffAdd"> is-flagq </span><span class="Normal DiffAdd">'</span><span class="String DiffAdd">-Ofast</span><span class="Normal DiffAdd">'</span><span class="DiffAdd"> </span><span class="Normal DiffAdd">;</span><span class="DiffAdd"> </span><span class="GruvboxRed DiffAdd">then</span><span class="DiffAdd">                                                                                                                        </span>
<span id="W2L262" class="LineNr">262 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># We can't unconditionally do this b/c we fortify needs</span><span class="DiffAdd">                                                                                                               </span>
<span id="W2L263" class="LineNr">263 </span><span class="DiffAdd">    </span><span class="Comment DiffAdd"># some level of optimisation.</span><span class="DiffAdd">                                                                                                                                         </span>
<span id="W2L264" class="LineNr">264 </span><span class="DiffAdd">    filter-flags </span><span class="GruvboxOrange DiffAdd">-D_FORTIFY_SOURCE</span><span class="Normal DiffAdd">=</span><span class="GruvboxPurple DiffAdd">3</span><span class="DiffAdd">                                                                                                                                      </span>
<span id="W2L265" class="LineNr">265 </span><span class="DiffAdd">    append-cppflags </span><span class="GruvboxOrange DiffAdd">-U_FORTIFY_SOURCE</span><span class="DiffAdd"> </span><span class="GruvboxOrange DiffAdd">-D_FORTIFY_SOURCE</span><span class="Normal DiffAdd">=</span><span class="GruvboxPurple DiffAdd">2</span><span class="DiffAdd">                                                                                                                 </span>
<span id="W2L266" class="LineNr">266 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W2L267" class="LineNr">267 </span><span class="DiffAdd"> </span><span class="DiffAdd">                                                                                                                                                                         </span>
<span id="W2L268" class="LineNr">268 </span>  python_setup
<span id="W2L269" class="LineNr">269 </span>
<span id="W2L270" class="LineNr">270 </span>  multilib-minimal_src_configure
<span id="W2L271" class="LineNr">271 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L272" class="LineNr">272 </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L273" class="LineNr">273 </span><span class="GruvboxGreenBold">multilib_src_configure() {</span>
<span id="W2L274" class="LineNr">274 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> myconf</span><span class="Normal">=</span><span class="GruvboxBlue">(</span>
<span id="W2L275" class="LineNr">275 </span>    <span class="GruvboxOrange">--localstatedir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/var</span><span class="Normal">&quot;</span>
<span id="W2L276" class="LineNr">276 </span><span class="DiffChange">    </span><span class="GruvboxOrange DiffText">-Dsupport-url</span><span class="Normal DiffText">=</span><span class="Normal DiffText">&quot;</span><span class="String DiffText"><a href="https://gentoo.org/support/">https://gentoo.org/support/</a></span><span class="Normal DiffText">&quot;</span><span class="DiffChange">                                                                                                                           </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L277" class="LineNr">277 </span>    <span class="GruvboxOrange">-Dpamlibdir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">getpam_mod_dir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span id="W2L278" class="LineNr">278 </span>    <span class="Comment"># avoid bash-completion dep</span>
<span id="W2L279" class="LineNr">279 </span>    <span class="GruvboxOrange">-Dbashcompletiondir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">get_bashcompdir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L280" class="LineNr">280 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use split-usr</span><span class="GruvboxAqua">)</span>
<span id="W2L281" class="LineNr">281 </span><span class="DiffChange">    </span><span class="GruvboxAqua DiffText">$(</span><span class="GruvboxOrange DiffText">meson_use split-usr split-bin</span><span class="GruvboxAqua DiffText">)</span><span class="DiffChange">                                                                                                                                      </span>
<span id="W2L282" class="LineNr">282 </span><span class="DiffChange">    </span><span class="GruvboxOrange DiffChange">-Drootprefix</span><span class="Normal DiffChange">=</span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">$(</span><span class="GruvboxOrange DiffText">usex split-usr </span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EPREFIX</span><span class="Normal DiffText">:-</span><span class="DiffText">/</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="GruvboxOrange DiffText"> </span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EPREFIX</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/usr</span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffChange">)</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                     </span>
<span id="W2L283" class="LineNr">283 </span>    <span class="GruvboxOrange">-Drootlibdir</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/usr/</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">get_libdir</span><span class="GruvboxAqua">)</span><span class="Normal">&quot;</span>
<span id="W2L284" class="LineNr">284 </span>    <span class="Comment"># Avoid infinite exec recursion, bug 642724</span>
<span id="W2L285" class="LineNr">285 </span>    <span class="GruvboxOrange">-Dtelinit-path</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EPREFIX</span><span class="GruvboxAqua">}</span><span class="String">/lib/sysvinit/telinit</span><span class="Normal">&quot;</span>
<span id="W2L286" class="LineNr">286 </span>    <span class="Comment"># no deps</span>
<span id="W2L287" class="LineNr">287 </span>    <span class="GruvboxOrange">-Dima</span><span class="Normal">=</span><span class="GruvboxRed">true</span>
<span id="W2L288" class="LineNr">288 </span>    <span class="GruvboxOrange">-Ddefault-hierarchy</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">usex cgroup-hybrid hybrid unified</span><span class="GruvboxAqua">)</span>
<span id="W2L289" class="Folded">289 </span><span class="Folded">+-- 18 lines: Optional components/dependencies--------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L307" class="LineNr">307 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool importd bzip2</span><span class="GruvboxAqua">)</span>
<span id="W2L308" class="LineNr">308 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool importd zlib</span><span class="GruvboxAqua">)</span>
<span id="W2L309" class="LineNr">309 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool kmod</span><span class="GruvboxAqua">)</span>
<span id="W2L310" class="LineNr">310 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use lz4</span><span class="GruvboxAqua">)</span>
<span id="W2L311" class="LineNr">311 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use lzma xz</span><span class="GruvboxAqua">)</span>
<span id="W2L312" class="LineNr">312 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use zstd</span><span class="GruvboxAqua">)</span>
<span id="W2L313" class="LineNr">313 </span><span class="DiffChange">    </span><span class="GruvboxAqua DiffChange">$(</span><span class="GruvboxOrange DiffChange">meson_native_use_bool </span><span class="GruvboxOrange DiffText">iptables</span><span class="GruvboxOrange DiffChange"> libiptc</span><span class="GruvboxAqua DiffChange">)</span><span class="DiffChange">                                                                                                                             </span>
<span id="W2L314" class="LineNr">314 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool openssl</span><span class="GruvboxAqua">)</span>
<span id="W2L315" class="LineNr">315 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_use pam</span><span class="GruvboxAqua">)</span>
<span id="W2L316" class="LineNr">316 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pkcs11 p11kit</span><span class="GruvboxAqua">)</span>
<span id="W2L317" class="LineNr">317 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pcre pcre2</span><span class="GruvboxAqua">)</span>
<span id="W2L318" class="LineNr">318 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool policykit polkit</span><span class="GruvboxAqua">)</span>
<span id="W2L319" class="LineNr">319 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool pwquality</span><span class="GruvboxAqua">)</span>
<span id="W2L320" class="LineNr">320 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool qrcode qrencode</span><span class="GruvboxAqua">)</span>
<span id="W2L321" class="LineNr">321 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool seccomp</span><span class="GruvboxAqua">)</span>
<span id="W2L322" class="LineNr">322 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool selinux</span><span class="GruvboxAqua">)</span>
<span id="W2L323" class="LineNr">323 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool tpm tpm2</span><span class="GruvboxAqua">)</span>
<span id="W2L324" class="LineNr">324 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool </span><span class="GruvboxRed">test</span><span class="GruvboxOrange"> dbus</span><span class="GruvboxAqua">)</span>
<span id="W2L325" class="LineNr">325 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_use_bool xkb xkbcommon</span><span class="GruvboxAqua">)</span>
<span id="W2L326" class="LineNr">326 </span><span class="DiffChange">    </span><span class="GruvboxOrange DiffText">-Dntp-servers</span><span class="Normal DiffText">=</span><span class="Normal DiffText">&quot;</span><span class="String DiffText">0.gentoo.pool.ntp.org 1.gentoo.pool.ntp.org 2.gentoo.pool.ntp.org 3.gentoo.pool.ntp.org</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">                                                               </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L327" class="LineNr">327 </span>    <span class="Comment"># Breaks screen, tmux, etc.</span>
<span id="W2L328" class="LineNr">328 </span>    <span class="GruvboxOrange">-Ddefault-kill-user-processes</span><span class="Normal">=</span><span class="GruvboxRed">false</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L329" class="LineNr">329 </span>    <span class="GruvboxOrange">-Dcreate-log-dirs</span><span class="Normal">=</span><span class="GruvboxRed">false</span>
<span id="W2L330" class="LineNr">330 </span>
<span id="W2L331" class="LineNr">331 </span>    <span class="Comment"># multilib options</span>
<span id="W2L332" class="LineNr">332 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true backlight</span><span class="GruvboxAqua">)</span>
<span id="W2L333" class="LineNr">333 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true binfmt</span><span class="GruvboxAqua">)</span>
<span id="W2L334" class="LineNr">334 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true coredump</span><span class="GruvboxAqua">)</span>
<span id="W2L335" class="Folded">335 </span><span class="Folded">+-- 10 lines: $(meson_native_true environment-d)------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L345" class="LineNr">345 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true rfkill</span><span class="GruvboxAqua">)</span>
<span id="W2L346" class="LineNr">346 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true sysusers</span><span class="GruvboxAqua">)</span>
<span id="W2L347" class="LineNr">347 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true timedated</span><span class="GruvboxAqua">)</span>
<span id="W2L348" class="LineNr">348 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true timesyncd</span><span class="GruvboxAqua">)</span>
<span id="W2L349" class="LineNr">349 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true tmpfiles</span><span class="GruvboxAqua">)</span>
<span id="W2L350" class="LineNr">350 </span>    <span class="GruvboxAqua">$(</span><span class="GruvboxOrange">meson_native_true vconsole</span><span class="GruvboxAqua">)</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L351" class="LineNr">351 </span>  )
<span id="W2L352" class="LineNr">352 </span>
<span id="W2L353" class="LineNr">353 </span>  meson_src_configure <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">myconf</span><span class="GruvboxAqua">[</span>@<span class="GruvboxAqua">]</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>
<span id="W2L354" class="LineNr">354 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L355" class="LineNr">355 </span>
<span id="W2L356" class="LineNr">356 </span><span class="GruvboxGreenBold">multilib_src_test() {</span>
<span id="W2L357" class="LineNr">357 </span>  <span class="GruvboxRed">unset</span><span class="GruvboxBlue"> DBUS_SESSION_BUS_ADDRESS XDG_RUNTIME_DIR</span>
<span id="W2L358" class="LineNr">358 </span>  meson_src_test
<span id="W2L359" class="LineNr">359 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L360" class="LineNr">360 </span>
<span id="W2L361" class="LineNr">361 </span><span class="GruvboxGreenBold">multilib_src_install_all() {</span>
<span id="W2L362" class="LineNr">362 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> rootprefix</span><span class="Normal">=</span><span class="GruvboxAqua">$(</span><span class="GruvboxOrange">usex split-usr </span><span class="Normal">''</span><span class="GruvboxOrange"> /usr</span><span class="GruvboxAqua">)</span>
<span id="W2L363" class="LineNr">363 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">local</span><span class="GruvboxBlue DiffAdd"> sbin</span><span class="Normal DiffAdd">=</span><span class="GruvboxAqua DiffAdd">$(</span><span class="GruvboxOrange DiffAdd">usex split-usr sbin bin</span><span class="GruvboxAqua DiffAdd">)</span><span class="DiffAdd">                                                                                                                                   </span>
<span id="W2L364" class="LineNr">364 </span>
<span id="W2L365" class="LineNr">365 </span>  <span class="Comment"># meson doesn't know about docdir</span>
<span id="W2L366" class="LineNr">366 </span>  <span class="GruvboxRed">mv</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/doc/<span class="GruvboxOrange">{</span>systemd,<span class="GruvboxAqua">${</span><span class="GruvboxAqua">PF</span><span class="GruvboxAqua">}</span><span class="GruvboxOrange">}</span> <span class="Normal">||</span> die
<span id="W2L367" class="LineNr">367 </span>
<span id="W2L368" class="LineNr">368 </span>  einstalldocs
<span id="W2L369" class="LineNr">369 </span><span class="DiffChange">  </span><span class="DiffText">dodoc </span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">FILESDIR</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="DiffText">/nsswitch.conf</span><span class="DiffChange">                                                                                                                                       </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L370" class="LineNr">370 </span>
<span id="W2L371" class="LineNr">371 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use resolvconf<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L372" class="LineNr">372 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">rm</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">-f</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">ED</span><span class="GruvboxAqua DiffChange">}${</span><span class="GruvboxAqua DiffChange">rootprefix</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffText">/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">sbin</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">/resolvconf </span><span class="Normal DiffChange">||</span><span class="DiffChange"> die</span><span class="DiffChange">                                                                                                                  </span>
<span id="W2L373" class="LineNr">373 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L374" class="LineNr">374 </span>
<span id="W2L375" class="LineNr">375 </span>  <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/etc/init.d/README <span class="Normal">||</span> die
<span id="W2L376" class="LineNr">376 </span>  <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}${</span><span class="GruvboxAqua">rootprefix</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/lib/systemd/system-generators/systemd-sysv-generator <span class="Normal">||</span> die
<span id="W2L377" class="LineNr">377 </span>
<span id="W2L378" class="LineNr">378 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use sysv-utils<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L379" class="LineNr">379 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">rm</span><span class="DiffChange"> </span><span class="Normal DiffChange">&quot;</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">ED</span><span class="GruvboxAqua DiffChange">}${</span><span class="GruvboxAqua DiffChange">rootprefix</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffText">/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">sbin</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">/</span><span class="GruvboxOrange DiffChange">{</span><span class="DiffChange">halt,init,poweroff,reboot,runlevel,shutdown,telinit</span><span class="GruvboxOrange DiffChange">}</span><span class="DiffChange"> </span><span class="Normal DiffChange">||</span><span class="DiffChange"> die</span><span class="DiffChange">                                                                          </span>
<span id="W2L380" class="LineNr">380 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/man/man1/init.<span class="GruvboxPurple">1</span> <span class="Normal">||</span> die
<span id="W2L381" class="LineNr">381 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/share/man/man8/<span class="GruvboxOrange">{</span>halt,poweroff,reboot,runlevel,shutdown,telinit<span class="GruvboxOrange">}</span>.<span class="GruvboxPurple">8</span> <span class="Normal">||</span> die
<span id="W2L382" class="LineNr">382 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L383" class="LineNr">383 </span>
<span id="W2L384" class="LineNr">384 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffChange">if </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> use resolvconf </span><span class="Normal DiffChange">&amp;&amp;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> use sysv-utils</span><span class="DiffText"> </span><span class="Normal DiffText">&amp;&amp;</span><span class="DiffText"> use split-usr</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                          </span>
<span id="W2L385" class="LineNr">385 </span>    <span class="GruvboxRed">rmdir</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}${</span><span class="GruvboxAqua">rootprefix</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/sbin <span class="Normal">||</span> die
<span id="W2L386" class="LineNr">386 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L387" class="LineNr">387 </span>
<span id="W2L388" class="LineNr">388 </span>  <span class="Comment"># <a href="https://bugs.gentoo.org/761763">https://bugs.gentoo.org/761763</a></span>
<span id="W2L389" class="LineNr">389 </span>  <span class="GruvboxRed">rm</span> <span class="GruvboxOrange">-r</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">ED</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span>/usr/lib/sysusers.d <span class="Normal">||</span> die
<span id="W2L390" class="LineNr">390 </span>
<span id="W2L391" class="LineNr">391 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># </span><span class="Comment DiffText">Preserve empty dirs in /etc &amp; /var, bug #437008</span><span class="DiffChange">                                                                                                                       </span>
<span id="W2L392" class="LineNr">392 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /etc/</span><span class="GruvboxOrange DiffText">{</span><span class="DiffText">binfmt.d,modules-load.d,tmpfiles.d</span><span class="GruvboxOrange DiffText">}</span><span class="DiffChange">                                                                                                                       </span>
<span id="W2L393" class="LineNr">393 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /etc/kernel/install.d</span><span class="DiffChange">                                                                                                                                           </span>
<span id="W2L394" class="LineNr">394 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /etc/systemd/</span><span class="GruvboxOrange DiffText">{</span><span class="DiffText">network,system,user</span><span class="GruvboxOrange DiffChange">}</span><span class="DiffChange">                                                                                                                              </span>
<span id="W2L395" class="LineNr">395 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /etc/udev/rules</span><span class="DiffChange">.d</span><span class="DiffChange">                                                                                                                                               </span>
<span id="W2L396" class="LineNr">396 </span><span class="DiffChange"> </span><span class="DiffChange">                                                                                                                                                                         </span>
<span id="W2L397" class="LineNr">397 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /etc/udev/hwdb</span><span class="DiffChange">.d</span><span class="DiffChange">                                                                                                                                                </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L398" class="LineNr">398 </span>
<span id="W2L399" class="LineNr">399 </span><span class="DiffChange">  </span><span class="DiffText">keepdir </span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">rootprefix</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="DiffText">/lib/systemd/</span><span class="GruvboxOrange DiffText">{</span><span class="DiffText">system-sleep,system-shutdown</span><span class="GruvboxOrange DiffText">}</span><span class="DiffChange">                                                                                                      </span>
<span id="W2L400" class="LineNr">400 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /usr/lib/</span><span class="GruvboxOrange DiffText">{</span><span class="DiffText">binfmt.d,modules-load.d</span><span class="GruvboxOrange DiffText">}</span><span class="DiffChange">                                                                                                                              </span>
<span id="W2L401" class="LineNr">401 </span><span class="DiffChange">  </span><span class="DiffText">keepdir /usr/lib/systemd/user-generators</span><span class="DiffChange">                                                                                                                                </span>
<span id="W2L402" class="LineNr">402 </span><span class="DiffAdd">  keepdir /var/lib/systemd</span><span class="DiffAdd">                                                                                                                                                </span>
<span id="W2L403" class="LineNr">403 </span><span class="DiffAdd">  keepdir /var/log/journal</span><span class="DiffAdd">                                                                                                                                                </span>
<span id="W2L404" class="LineNr">404 </span>
<span id="W2L405" class="LineNr">405 </span><span class="DiffChange">  </span><span class="Comment DiffChange"># </span><span class="Comment DiffText">Symlink /etc/sysctl.conf for easy migratio</span><span class="Comment DiffChange">n.</span><span class="DiffChange">                                                                                                                          </span>
<span id="W2L406" class="LineNr">406 </span><span class="DiffChange">  </span><span class="DiffText">dosym ../../../etc/sysctl.conf /usr/lib/sysctl.d/99-sysctl.conf</span><span class="DiffChange">                                                                                                         </span>
<span id="W2L407" class="LineNr">407 </span><span class="DiffChange"> </span><span class="DiffChange">                                                                                                                                                                         </span>
<span id="W2L408" class="LineNr">408 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffText">if </span><span class="DiffText">use pam</span><span class="Normal DiffText">;</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">then</span><span class="DiffChange">                                                                                                                                                        </span>
<span id="W2L409" class="LineNr">409 </span><span class="DiffAdd">    newpamd </span><span class="Normal DiffAdd">&quot;</span><span class="GruvboxAqua DiffAdd">${</span><span class="GruvboxAqua DiffAdd">FILESDIR</span><span class="GruvboxAqua DiffAdd">}</span><span class="Normal DiffAdd">&quot;</span><span class="DiffAdd">/systemd-user.pam systemd-user</span><span class="DiffAdd">                                                                                                                   </span>
<span id="W2L410" class="LineNr">410 </span><span class="DiffAdd">  </span><span class="GruvboxRed DiffAdd">fi</span><span class="DiffAdd">                                                                                                                                                                      </span>
<span id="W2L411" class="LineNr">411 </span>
<span id="W2L412" class="LineNr">412 </span>  <span class="GruvboxRed">if </span>use split-usr<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L413" class="LineNr">413 </span>    <span class="Comment"># Avoid breaking boot/reboot</span>
<span id="W2L414" class="LineNr">414 </span>    dosym ../../../lib/systemd/systemd /usr/lib/systemd/systemd
<span id="W2L415" class="LineNr">415 </span>    dosym ../../../lib/systemd/systemd-shutdown /usr/lib/systemd/systemd-shutdown
<span id="W2L416" class="LineNr">416 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L417" class="LineNr">417 </span>
<span id="W2L418" class="LineNr">418 </span><span class="DiffChange">  </span><span class="DiffText">gen_usr_ldscript </span><span class="GruvboxOrange DiffText">-a</span><span class="DiffText"> systemd udev</span><span class="DiffChange">                                                                                                                                        </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L419" class="LineNr">419 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L420" class="LineNr">420 </span>
<span id="W2L421" class="LineNr">421 </span><span class="GruvboxGreenBold">migrate_locale() {</span>
<span id="W2L422" class="LineNr">422 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> envd_locale_def</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/etc/env.d/02locale</span><span class="Normal">&quot;</span>
<span id="W2L423" class="LineNr">423 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> envd_locale</span><span class="Normal">=</span><span class="GruvboxBlue">( </span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="Normal">&quot;</span><span class="GruvboxBlue">/etc/env.d/??locale </span>)
<span id="W2L424" class="LineNr">424 </span>  <span class="GruvboxRed">local</span><span class="GruvboxBlue"> locale_conf</span><span class="Normal">=</span><span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/etc/locale.conf</span><span class="Normal">&quot;</span>
<span id="W2L425" class="Folded">425 </span><span class="Folded">+-- 37 lines: if [[ ! -L ${locale_conf} &amp;&amp; ! -e ${locale_conf} ]]; then-------------------------------------------------------------------------------------------------------</span>
<span id="W2L462" class="LineNr">462 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L463" class="LineNr">463 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L464" class="LineNr">464 </span>
<span id="W2L465" class="LineNr">465 </span><span class="GruvboxGreenBold">pkg_preinst() {</span>
<span id="W2L466" class="LineNr">466 </span>  <span class="GruvboxRed">if </span><span class="GruvboxRed">!</span> use split-usr<span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L467" class="LineNr">467 </span>    <span class="GruvboxRed">local</span><span class="GruvboxBlue"> dir</span>
<span id="W2L468" class="LineNr">468 </span><span class="DiffChange">    </span><span class="GruvboxRed DiffChange">for</span><span class="DiffChange"> dir </span><span class="GruvboxRed DiffChange">in</span><span class="DiffChange"> bin sbin lib</span><span class="DiffText"> usr/sbin</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">do</span><span class="DiffChange">                                                                                                                                  </span>
<span id="W2L469" class="LineNr">469 </span><span class="DiffChange">      </span><span class="GruvboxRed DiffChange">if </span><span class="GruvboxOrange DiffChange">[[</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">!</span><span class="DiffChange"> </span><span class="GruvboxRed DiffText">-L</span><span class="DiffText"> </span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffChange">/</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">dir</span><span class="GruvboxAqua DiffChange">}</span><span class="DiffChange"> </span><span class="GruvboxOrange DiffChange">]]</span><span class="Normal DiffChange">;</span><span class="DiffChange"> </span><span class="GruvboxRed DiffChange">then</span><span class="DiffChange">                                                                                                                                 </span>
<span id="W2L470" class="LineNr">470 </span><span class="DiffChange">        eerror </span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">'</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">EROOT</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">/</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">dir</span><span class="GruvboxAqua DiffText">}</span><span class="String DiffText">' is not a symbolic link</span><span class="String DiffChange">.</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                                                                </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L471" class="LineNr">471 </span>        <span class="GruvboxBlue">FAIL</span>=<span class="GruvboxPurple">1</span>
<span id="W2L472" class="LineNr">472 </span>      <span class="GruvboxRed">fi</span>
<span id="W2L473" class="LineNr">473 </span>    <span class="GruvboxRed">done</span>
<span id="W2L474" class="LineNr">474 </span>    <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FAIL</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L475" class="LineNr">475 </span>      eerror <span class="Normal">&quot;</span><span class="String">Migration to system layout with merged directories must be performed before</span><span class="Normal">&quot;</span>
<span id="W2L476" class="LineNr">476 </span><span class="DiffChange">      eerror </span><span class="Normal DiffChange">&quot;</span><span class="String DiffText">install</span><span class="String DiffChange">ing </span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">CATEGORY</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange">/</span><span class="GruvboxAqua DiffChange">${</span><span class="GruvboxAqua DiffChange">PN</span><span class="GruvboxAqua DiffChange">}</span><span class="String DiffChange"> with USE=</span><span class="GruvboxOrange DiffChange">\&quot;</span><span class="String DiffChange">-split-usr</span><span class="GruvboxOrange DiffChange">\&quot;</span><span class="String DiffChange"> to avoid run-time breakage.</span><span class="Normal DiffChange">&quot;</span><span class="DiffChange">                                                                           </span>
<span id="W2L477" class="LineNr">477 </span>      die <span class="Normal">&quot;</span><span class="String">System layout with split directories still used</span><span class="Normal">&quot;</span>
<span id="W2L478" class="LineNr">478 </span>    <span class="GruvboxRed">fi</span>
<span id="W2L479" class="LineNr">479 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L480" class="LineNr">480 </span><span class="GruvboxGreenBold">}</span>
<span id="W2L481" class="LineNr">481 </span>
<span id="W2L482" class="LineNr">482 </span><span class="GruvboxGreenBold">pkg_postinst() {</span>
<span id="W2L483" class="Folded">483 </span><span class="Folded">+--  6 lines: systemd_update_catalog------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L489" class="LineNr">489 </span>  udev_reload <span class="Normal">||</span> <span class="GruvboxBlue">FAIL</span>=<span class="GruvboxPurple">1</span>
<span id="W2L490" class="LineNr">490 </span>
<span id="W2L491" class="LineNr">491 </span>  <span class="Comment"># Bug 465468, make sure locales are respected, and ensure consistency</span>
<span id="W2L492" class="LineNr">492 </span>  <span class="Comment"># between OpenRC &amp; systemd</span>
<span id="W2L493" class="LineNr">493 </span>  migrate_locale
<span id="W2L494" class="LineNr">494 </span>
<span id="W2L495" class="LineNr">495 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffText">if </span><span class="GruvboxOrange DiffText">[[</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">-z</span><span class="DiffText"> </span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">REPLACING_VERSIONS</span><span class="GruvboxAqua DiffText">}</span><span class="DiffText"> </span><span class="GruvboxOrange DiffText">]]</span><span class="Normal DiffText">;</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">then</span><span class="DiffChange">                                                                                                                                 </span>
<span id="W2L496" class="LineNr">496 </span><span class="DiffChange">  </span><span class="DiffText">  </span><span class="GruvboxRed DiffText">if </span><span class="GruvboxRed DiffText">type</span><span class="DiffText"> systemctl </span><span class="Normal DiffText">&amp;</span><span class="GruvboxRed DiffText">&gt;</span><span class="DiffText">/dev/null</span><span class="Normal DiffText">;</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">then</span><span class="DiffChange">                                                                                                                                   </span>
<span id="W2L497" class="LineNr">497 </span><span class="DiffChange">  </span><span class="DiffText">    systemctl </span><span class="GruvboxOrange DiffText">--root</span><span class="Normal DiffText">=</span><span class="Normal DiffText">&quot;</span><span class="GruvboxAqua DiffText">${</span><span class="GruvboxAqua DiffText">ROOT</span><span class="Normal DiffText">:-</span><span class="DiffText">/</span><span class="GruvboxAqua DiffText">}</span><span class="Normal DiffText">&quot;</span><span class="DiffText"> </span><span class="GruvboxRed DiffText">enable</span><span class="DiffText"> getty@.service remote-fs.target </span><span class="Normal DiffText">||</span><span class="DiffText"> </span><span class="GruvboxBlue DiffText">FAIL</span><span class="DiffText">=</span><span class="GruvboxPurple DiffText">1</span><span class="DiffChange">                                                                                      </span>
<span id="W2L498" class="LineNr">498 </span><span class="DiffChange">  </span><span class="DiffText">  </span><span class="GruvboxRed DiffText">fi</span><span class="DiffChange">                                                                                                                                                                    </span>
<span id="W2L499" class="LineNr">499 </span><span class="DiffChange">  </span><span class="DiffText">  elog </span><span class="Normal DiffText">&quot;</span><span class="String DiffText">To enable a useful set of services, run the following:</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">                                                                                                         </span>
<span id="W2L500" class="LineNr">500 </span><span class="DiffChange">  </span><span class="DiffText">  elog </span><span class="Normal DiffText">&quot;</span><span class="String DiffText">  systemctl preset-all --preset-mode=enable-only</span><span class="Normal DiffText">&quot;</span><span class="DiffChange">                                                                                                               </span>
<span id="W2L501" class="LineNr">501 </span><span class="DiffChange">  </span><span class="GruvboxRed DiffText">fi</span><span class="DiffChange">                                                                                                                                                                      </span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="LineNr">    </span><span class="DiffDelete">--------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="W2L502" class="LineNr">502 </span>
<span id="W2L503" class="LineNr">503 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxRed">-L</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/var/lib/systemd/timesync</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L504" class="LineNr">504 </span>    <span class="GruvboxRed">rm</span> <span class="Normal">&quot;</span><span class="GruvboxAqua">${</span><span class="GruvboxAqua">EROOT</span><span class="GruvboxAqua">}</span><span class="String">/var/lib/systemd/timesync</span><span class="Normal">&quot;</span>
<span id="W2L505" class="LineNr">505 </span>  <span class="GruvboxRed">fi</span>
<span id="W2L506" class="LineNr">506 </span>
<span id="W2L507" class="LineNr">507 </span>  <span class="GruvboxRed">if </span><span class="GruvboxOrange">[[</span> <span class="GruvboxAqua">${</span><span class="GruvboxAqua">FAIL</span><span class="GruvboxAqua">}</span> <span class="GruvboxOrange">]]</span><span class="Normal">;</span> <span class="GruvboxRed">then</span>
<span id="W2L508" class="Folded">508 </span><span class="Folded">+-- 13 lines: eerror &quot;One of the postinst commands failed. Please check the postinst output&quot;----------------------------------------------------------------------------------</span>
</pre>
</div></td>
</tr>
</table>
</body>
</html>
<!-- vim: set foldmethod=manual : -->

